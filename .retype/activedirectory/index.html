<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.11.0.807698450452">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.11.0">

    <!-- Primary Meta Tags -->
    <title>Powershell Magic </title>
    <meta name="title" content="Powershell Magic ">
    <meta name="description" content="So as mentioned in my last blog a couple of the puppies seemed to be having issues opening their eyes, which is common in the Shar-Pei breed, as they...">

    <!-- Canonical -->
    <link rel="canonical" href="https://powershellmagic.netlify.app/activedirectory/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://powershellmagic.netlify.app/activedirectory/">
    <meta property="og:title" content="Powershell Magic ">
    <meta property="og:description" content="So as mentioned in my last blog a couple of the puppies seemed to be having issues opening their eyes, which is common in the Shar-Pei breed, as they...">
    <meta property="og:image" content="https://powershellmagic.netlify.app/images/pups.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://powershellmagic.netlify.app/activedirectory/">
    <meta property="twitter:title" content="Powershell Magic ">
    <meta property="twitter:description" content="So as mentioned in my last blog a couple of the puppies seemed to be having issues opening their eyes, which is common in the Shar-Pei breed, as they...">
    <meta property="twitter:image" content="https://powershellmagic.netlify.app/images/pups.jpg">

    <script data-cfasync="false">(function(){var cl=document.documentElement.classList,ls=localStorage.getItem("retype_scheme"),hd=cl.contains("dark"),hl=cl.contains("light"),wm=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;if(ls==="dark"||(!ls&&wm&&!hd&&!hl)){cl.remove("light");cl.add("dark")}else if(ls==="light"||(!ls&&!wm&&!hd&&!hl)){cl.remove("dark");cl.add("light")}})();</script>

    <link href="../logo.png" rel="icon">
    <link href="../resources/css/retype.css?v=3.11.0.807698450452" rel="stylesheet">

    <script data-cfasync="false" src="../resources/js/config.js?v=3.11.0.807698450452" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../resources/js/retype.js?v=3.11.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../resources/js/lunr.js?v=3.11.0.807698450452" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../resources/js/prism.js?v=3.11.0.807698450452" defer></script>
</head>
<body>
    <div id="retype-app" class="relative text-base antialiased text-base-text bg-base-bg font-body">
        <div class="absolute bottom-0 left-0" style="top: 5rem; right: 50%"></div>
    
        <header id="retype-header" class="sticky top-0 z-30 flex w-full h-16 bg-header-bg border-b border-header-border md:h-20">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton retype-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="retype-sidebar-left-toggle-button"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="retype-branding-logo" href="../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../logodark.png">
                            </span>
                            <span class="dark:text-white font-bold line-clamp-1 md:line-clamp-2">Automation Ideas</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block border-base-border"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav id="retype-header-nav" class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://adam-bacon.netlify.app/">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                        </g>
                                    </svg>
                                    <span>Old Blog Site</span>
                                </a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-search-placeholder transition-colors duration-200 ease-in bg-search-bg border border-transparent rounded md:text-sm hover:border-search-border-hover focus:outline-none focus:border-search-border-focus" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="retype-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
    
        <div id="retype-container" class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-sidebar-left-bg border-sidebar-left-border sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton">
            
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-filter-bg border border-filter-border rounded shadow-none text-sm focus:outline-none focus:border-filter-border-focus" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-base-border">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-base-border">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-base-border">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://adam-bacon.netlify.app/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                                </g>
                                            </svg>
                                            <span>Old Blog Site</span>
                                        </a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 bg-body-bg">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div id="retype-main" class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="retype-markdown" id="retype-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="retype-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="powershell-magic" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#powershell-magic">#</doc-anchor-trigger>
        <span>Powershell Magic <span class="no-link inline-flex align-middle items-center justify-center font-medium leading-none whitespace-nowrap text-badge-warning-text bg-badge-warning border border-badge-warning-border h-6 px-2 text-xs rounded-md">
            <span>Back once again with the Powershell <span class="docs-emoji">&#x1F953;</span> flavour</span>
        </span></span>
    </h1>
</doc-anchor-target>
<div class="-mt-3 mb-12 flex flex-wrap text-sm text-gray-400 dark:text-dark-350 items-center print:justify-center">
    <div class="flex items-center">
        <div>By</div>
        <div class="ml-2 flex items-center">
          <div class="shrink-0 w-8 h-8 overflow-hidden rounded-full">
            <a href="mailto:adambacon1@hotmail.com"><img class="object-cover" src="https://www.gravatar.com/avatar/aa37a353fed4270a1b0c39b827ee1d23?d=mp"></a>
          </div>
          <div class="ml-1 whitespace-nowrap text-gray-500 dark:text-dark-350"><a href="mailto:adambacon1@hotmail.com">Adam Bacon</a></div>
        </div>
    </div>
    <div class="mx-2">&#9679;</div>
    <div class="flex items-center shrink-0">Published&nbsp;<span>2025-08-04</span></div>
</div>

<doc-anchor-target id="puppy-update">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#puppy-update">#</doc-anchor-trigger>
        <span>Puppy update</span>
    </h2>
</doc-anchor-target>
<p>So as mentioned in my last blog a couple of the puppies seemed to be having issues opening their eyes, which is common in the Shar-Pei breed, as they are so wrinkly basically their eyelids can roll in on the eyes, and needs immediate attention, as this can lead to more problems the main one blindness.</p>
<p>My wife and I took two to the vets immediately, not my local one as they had no appoinment slots, only to be informed that they were fine and was sent home, and the vet mentioned eye drops if it got worse. Less than a day later could see the pups were having discharge from the eyes, so phoned vet back.  Only to be told that the vet we saw was now on holiday, and no notes were left about the eye drops, which meant another consultation fee to pay and a different vet to see in my local vets.</p>
<p>Again seemed pretty pointless, as they did not know what eye drops to prescribe and they needed to contact this vet eye specialist in Bideford. My wife got on the case and contacted them directly, and another consultation fee and another visit. By now my wife had noticed that another pups eye had closed, just the one which was previously okay. So off we went to the vets for yet another consultation, but this time hopefully an answer to the problem.  So in total all these visits and the eye tacking operation which was required has now set me back I think £1,247 in total. So very grateful I have a job to have been able to pay for this, but yeah an unexpected cost which I could have done without, but I love my animals as they are part of the family, and although I plan to sell these pups minus the white one with a cone on it&#x27;s head, as I do not think 10 dogs in the house is practical I still love them to bits and want the best for them.</p>
<p><figure class="content-center">
    <img src="../images/pups.jpg" alt="Got 3 cone head pups now" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">Got 3 cone head pups now</figcaption>
</figure>
</p>
<p>So thankfully after all the drama of like visiting 3 different vets, finally got these little pups to the right vets who were amazing with the work they done, as they are only 3 weeks old.</p>
<doc-anchor-target id="background-to-issue">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#background-to-issue">#</doc-anchor-trigger>
        <span>Background to issue</span>
    </h2>
</doc-anchor-target>
<p>Right now I got all my puppy problems out the way I can now focus on writing a new problem and Powershell solution to that problem. The background to this problem is the <strong>MemberOf</strong> tab within a user account in <strong>Active Directory</strong></p>
<p>Well that is not a problem in itself, infact it is really handy to show you would groups a particular user is a member of within Active Directory.  Not long after I started this job, I realised this is a big company with thousands and thousands of users. To further complicate things this is the first company I have worked at which uses <strong>Role Based Access Control</strong> aka RBAC. So although the 200+ scripts I look after which do all the on-boarding for users sometimes the data that these accounts are created off could not hold the right information (I have no control over the CSV data) and like the saying goes <strong>bad data in bad data out</strong>
Despite raising this numerous times to fix the underlying issue, the people in-charge of the spreadsheet obviously like to keep me on my toes.  Also as not all people in the company might not appreciate the rules configured for RBAC you could have HR change loads of peoples departments, or job titles. This then means that those people are automatically removed from RBAC groups as they no longer meet the given criteria to be in that group. This then leads to being asked why <strong>user A</strong> can still access what they need but <strong>user B</strong> can now no longer access the things that they used to be able to access which was the same as <strong>user A</strong></p>
<p>Although I am not office based I know that people will look at the <strong>MemberOf</strong> tab in <strong>Active Directory</strong> with two user accounts side-by-side and try to do a spot the difference between them.  Due to the size of the company I work for also adds a crazy amount of Active Directory groups. So this then becomes a mission to identify the missing group or groups due to the size of the lists shown.</p>
<p><figure class="content-center">
    <img src="../images/clone.png" alt="Do not let spotting the difference lead to situations like this" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">Do not let spotting the difference lead to situations like this</figcaption>
</figure>
</p>
<doc-anchor-target id="what-was-the-problem">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#what-was-the-problem">#</doc-anchor-trigger>
        <span>What was the problem?</span>
    </h2>
</doc-anchor-target>
<p>Within the first month this problem had presented itself a few times, so wanting to make a good impression and solve this easily going forward I cooked up a very basic function.  Honestly I have now used this hundreds of times, and given it to numerous people in numerous IT departments as it has saved my <span class="docs-emoji">&#x1F953;</span> so many times when I get asked about why this account cannot do something when another account who should have the same access can.</p>
<div class="flex mb-6">
    <div class="shrink-0 w-1.5 rounded-tl-lg rounded-bl-lg bg-callout-primary"></div>
    <div class="flex w-full py-4 border border-l-0 rounded-tr-lg rounded-br-lg doc-callout bg-callout-base-bg border-callout-base-border" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-callout-primary" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Occam’s Razor</h5>
<p>Put simply, states: “the simplest solution is almost always the best.” It’s a problem-solving principle arguing that simplicity is better than complexity. Named after 14th-century logician and theologian William of Ockham, this theory has been helping many great thinkers for centuries.</p>
        </div>
    </div>
</div>
<p>Although I was not thinking good old Occam&#x27;s Razor when I did this, I was thinking that this simple solution would solve this issue in no-time, and it was so simple I kept it as a basic Powershell function, sometimes the simple solution is the best solution. Just crazy how many times I have used this, and even the same people asking me who I have previously given this same function to still ask me, and I run this function, then the issue is revealed which group or groups are missing from one account that the other account has.</p>
<doc-anchor-target id="get-adgroupdifference">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#get-adgroupdifference">#</doc-anchor-trigger>
        <span>Get-ADGroupDifference</span>
    </h2>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock line-numbers>
<pre translate="no" class="language-powershell"><code v-pre class="language-powershell">Function Get-ADGroupDifference ($u1,$u2){
    $user1 = (get-aduser $u1 -Properties memberof).memberof | Get-ADGroup | sort name | Select-Object -expand name
    $user2 = (get-aduser $u2 -Properties memberof).memberof | Get-ADGroup | sort name | Select-Object -expand name
    $Global:groups = Compare-Object -ReferenceObject $user1 -DifferenceObject $user2 -IncludeEqual | Select @{n=&quot;GroupName&quot;;e={$_.InputObject}},SideIndicator,@{n=&quot;Same&quot;;e={if ($_.SideIndicator -eq '=='){&quot;Equal Access&quot;}}},@{n=&quot;$u1&quot;;e={if ($_.SideIndicator -eq '&lt;='){$u1}}},@{n=&quot;$u2&quot;;e={if ($_.SideIndicator -eq '=&gt;'){$u2}}}
    $groups| Out-Gridview 
}

Get-ADGroupDifference userA userB</code></pre>
</doc-codeblock></div>
<p>You may have noticed that I use the <strong>$Global</strong> parameter here to store the outcome of the display. I also use the <strong>Out-GridView</strong> cmdlet to allow easy viewing, sorting and filtering of the data presented.</p>
<doc-anchor-target id="bonus-solution">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#bonus-solution">#</doc-anchor-trigger>
        <span>Bonus solution</span>
    </h2>
</doc-anchor-target>
<p>The bonus feature is putting this to even more use. If you have managed Active Directory you most likely have been asked that you want <strong>userB</strong> to have the same permissions or access as <strong>userA</strong> now I know a lot of people do tend to just copy accounts, but that is not best practices as you do not know exactly what you are copying, and if userB account already exists in Active Directory you do not want to be deleting that account and creating a new copied account as it will get a new GUID and will not match the cloud linked Active Directory account anymore and well it might seem a simple solution, but in this instance it is most certainly not the best solution or idea.</p>
<p>So to achieve being able to say automatically give userB everything that userA has we can simply add a few more lines of code:</p>
<div class="codeblock-wrapper"><doc-codeblock line-numbers>
<pre translate="no" class="language-powershell"><code v-pre class="language-powershell">Function Get-ADGroupDifference ($u1,$u2){
$user1 = (get-aduser $u1 -Properties memberof).memberof | Get-ADGroup | sort name | Select-Object -expand name
$user2 = (get-aduser $u2 -Properties memberof).memberof | Get-ADGroup | sort name | Select-Object -expand name
$Global:groups = Compare-Object -ReferenceObject $user1 -DifferenceObject $user2 -IncludeEqual | Select @{n=&quot;GroupName&quot;;e={$_.InputObject}},SideIndicator,@{n=&quot;Same&quot;;e={if ($_.SideIndicator -eq '=='){&quot;Equal Access&quot;}}},@{n=&quot;$u1&quot;;e={if ($_.SideIndicator -eq '&lt;='){$u1}}},@{n=&quot;$u2&quot;;e={if ($_.SideIndicator -eq '=&gt;'){$u2}}} # | ? GroupName -Match &quot;doc&quot;
$groups| Out-Gridview 
}
Get-ADGroupDifference userA userB
$missingGroups = $Global:groups | ? {$_.SideIndicator -EQ '&lt;='} | Select -ExpandProperty GroupName

foreach ($group in $missingGroups){
    Add-ADGroupMember -Identity $group -members userB
    Write-host -ForegroundColor Green &quot;Added userB to $group&quot;    
    }</code></pre>
</doc-codeblock></div>
<p>This time a double-whammy solution to the age old problem of differences in Active Directory accounts. I know I could have even jazzed up this function for this blog, but <strong>it is what it is</strong> which has become my saying of late with all the unexpected news I have recently had.</p>
<doc-anchor-target id="something-to-share">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#something-to-share">#</doc-anchor-trigger>
        <span>Something to share</span>
    </h2>
</doc-anchor-target>
<p>Again I need to make some new beats but life has been rather hectic of late, so I hope you enjoy this tune I made not so long ago <span class="docs-emoji">&#x1F3B5;</span></p>
<div class="aspect-video w-full rounded-lg overflow-hidden mb-6 shadow-lg dark:shadow-lg">
    <iframe src="https://www.youtube.com/embed/aN4zVYe-tB8" frameborder="0" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen class="w-full h-full"></iframe>
</div>
                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer id="retype-content-footer" class="clear-both">
                            
                                <nav id="retype-nextprev" class="print:hidden flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-r rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../combineimages/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-base-text-muted">Previous</span>
                                                <span class="block mt-1">Combine Images</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div id="retype-page-footer" class="print:border-none border-t border-base-border pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between print:justify-center">
                                <div id="retype-footer-links" class="print:hidden">
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div id="retype-copyright" class="print:justify-center py-2 text-footer-text font-footer-link-weight text-sm leading-relaxed"><p>© Copyright 2025. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-sidebar-right-bg border-sidebar-right-border lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="retype-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "Active Directory", level: 1, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
