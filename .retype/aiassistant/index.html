<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.11.0.817230017670">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.11.0">

    <!-- Primary Meta Tags -->
    <title>Powershell Magic </title>
    <meta name="title" content="Powershell Magic ">
    <meta name="description" content="So I get hooked on things, and once I am hooked I will spend a lot of time on the thing that has hooked me.">

    <!-- Canonical -->
    <link rel="canonical" href="https://powershellmagic.netlify.app/aiassistant/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://powershellmagic.netlify.app/aiassistant/">
    <meta property="og:title" content="Powershell Magic ">
    <meta property="og:description" content="So I get hooked on things, and once I am hooked I will spend a lot of time on the thing that has hooked me.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://powershellmagic.netlify.app/aiassistant/">
    <meta property="twitter:title" content="Powershell Magic ">
    <meta property="twitter:description" content="So I get hooked on things, and once I am hooked I will spend a lot of time on the thing that has hooked me.">

    <script data-cfasync="false">(function(){var cl=document.documentElement.classList,ls=localStorage.getItem("retype_scheme"),hd=cl.contains("dark"),hl=cl.contains("light"),wm=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;if(ls==="dark"||(!ls&&wm&&!hd&&!hl)){cl.remove("light");cl.add("dark")}else if(ls==="light"||(!ls&&!wm&&!hd&&!hl)){cl.remove("dark");cl.add("light")}})();</script>

    <link href="../logo.png" rel="icon">
    <link href="../resources/css/retype.css?v=3.11.0.817230017670" rel="stylesheet">

    <script data-cfasync="false" src="../resources/js/config.js?v=3.11.0.817230017670" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../resources/js/retype.js?v=3.11.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../resources/js/lunr.js?v=3.11.0.817230017670" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../resources/js/prism.js?v=3.11.0.817230017670" defer></script>
</head>
<body>
    <div id="retype-app" class="relative text-base antialiased text-base-text bg-base-bg font-body">
        <div class="absolute bottom-0 left-0" style="top: 5rem; right: 50%"></div>
    
        <header id="retype-header" class="sticky top-0 z-30 flex w-full h-16 bg-header-bg border-b border-header-border md:h-20">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton retype-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="retype-sidebar-left-toggle-button"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="retype-branding-logo" href="../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../logodark.png">
                            </span>
                            <span class="dark:text-white font-bold line-clamp-1 md:line-clamp-2">Automation Ideas</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block border-base-border"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav id="retype-header-nav" class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://adam-bacon.netlify.app/">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                        </g>
                                    </svg>
                                    <span>Old Blog Site</span>
                                </a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-search-placeholder transition-colors duration-200 ease-in bg-search-bg border border-transparent rounded md:text-sm hover:border-search-border-hover focus:outline-none focus:border-search-border-focus" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="retype-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
    
        <div id="retype-container" class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-sidebar-left-bg border-sidebar-left-border sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton">
            
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-filter-bg border border-filter-border rounded shadow-none text-sm focus:outline-none focus:border-filter-border-focus" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-base-border">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-base-border">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-base-border">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://adam-bacon.netlify.app/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                                </g>
                                            </svg>
                                            <span>Old Blog Site</span>
                                        </a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 bg-body-bg">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div id="retype-main" class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="retype-markdown" id="retype-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="retype-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="powershell-magic" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#powershell-magic">#</doc-anchor-trigger>
        <span>Powershell Magic <span class="no-link inline-flex align-middle items-center justify-center font-medium leading-none whitespace-nowrap text-badge-warning-text bg-badge-warning border border-badge-warning-border h-6 px-2 text-xs rounded-md">
            <span>Back once again with the Powershell <span class="docs-emoji">&#x1F953;</span> flavour</span>
        </span></span>
    </h1>
</doc-anchor-target>
<div class="-mt-3 mb-12 flex flex-wrap text-sm text-gray-400 dark:text-dark-350 items-center print:justify-center">
    <div class="flex items-center">
        <div>By</div>
        <div class="ml-2 flex items-center">
          <div class="shrink-0 w-8 h-8 overflow-hidden rounded-full">
            <a href="mailto:adambacon1@hotmail.com"><img class="object-cover" src="https://www.gravatar.com/avatar/aa37a353fed4270a1b0c39b827ee1d23?d=mp"></a>
          </div>
          <div class="ml-1 whitespace-nowrap text-gray-500 dark:text-dark-350"><a href="mailto:adambacon1@hotmail.com">Adam Bacon</a></div>
        </div>
    </div>
    <div class="mx-2">&#9679;</div>
    <div class="flex items-center shrink-0">Published&nbsp;<span>2025-09-17</span></div>
</div>

<doc-anchor-target id="random-ramble">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#random-ramble">#</doc-anchor-trigger>
        <span>Random Ramble</span>
    </h2>
</doc-anchor-target>
<p>So I get hooked on things, and once I am hooked I will spend a lot of time on the thing that has hooked me. So till recently this was making music in my spare time. I have always loved music but never really knew much on music theory, so I got hooked learning this and how to construct your own tunes within the DAW you use to make music. Then more recently I purchased some portable music equipment a chord synth, and a groovebox. Hence I keep dropping the something to share at the end of these blogs.</p>
<p>So the other night it got me thinking about these realistic videos that people are using AI to make for them, and some of them are really good or very believable the way they are done.  I mean think back to older 80s movies and the special effects compared to today are awful, but at the time it looked great. To have the power to use AI to make these amazing looking videos, is really mind blowing to me. Maybe in 30+ years these to will look really lame in comparison to the tech available. Hopefully I will live long enough to see that day.</p>
<p>Anyways the reason I am rambling is not only to fill up page space but share some of my own AI videos, but using the images I have also used AI to generate and included in previous blog pages, but I was amazed at from just a single image what AI could then produce from that. This is a video of the image I normally put at the top of each blog page, the PowerShell hero. With an upside-down PowerShell logo.</p>
<p><strong>If I was superhero I would certainly be saying things like this</strong></p>
<div class="aspect-video w-full rounded-lg overflow-hidden mb-6 shadow-lg dark:shadow-lg">
    <iframe src="https://www.youtube.com/embed/xZnO9Sx4NLQ" frameborder="0" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen class="w-full h-full"></iframe>
</div><doc-anchor-target id="ai-help">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ai-help">#</doc-anchor-trigger>
        <span>AI Help</span>
    </h2>
</doc-anchor-target>
<p>Yes it has changed the way things are now being done since AI has been released to the public. Lots of companies are embracing AI and making it do the work for them, or using it to streamline processes to get faster results for either the business or end customer. Again it has also put certain people out of work, because now there is a dedicated AI assistant to do the work. A bit like the new self-service checkouts they have at many superstores these days, I am sure they have put people out of work too. As normally just one person monitoring all the self-service checkouts rather than having to employ someone for each checkout, now maybe 20 checkouts are all being used but now only one staff member managing them all.</p>
<p>Although AI might not always produce 100% usable results, it certainly can assist you with building ideas.  I mean if AI was about when I got learning PowerShell it would feel like the holy grail, but at the same time I would not be able to spot the possible mistakes in the code it might produce, it might then have made me more reliant on AI other than the paper back books I bought to get me started. Even though when I read some of those books not much of it made sense, but I knew if I kept reading eventually things would stick in my brain. So please if you have started your journey scripting, and thinking of quitting after a few weeks or months because you still cannot write scripts first time, or the process takes days. That&#x27;s fine, just keep learning you will get better, I should be living proof of that.</p>
<p>This is another reason I write these blogs to hopefully encourage you as the reader to keep learning as I totally relate to this being a very long journey up a very steep mountain.  You will eventually reach the top by sticking to the goal of learning and climbing up that mountain by solving obstacles you are presented with using PowerShell and the things you have learnt.</p>
<div class="aspect-video w-full rounded-lg overflow-hidden mb-6 shadow-lg dark:shadow-lg">
    <iframe src="https://www.youtube.com/embed/8FpeVFaF0S0" frameborder="0" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen class="w-full h-full"></iframe>
</div><doc-anchor-target id="winners-dont-use-ai">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#winners-dont-use-ai">#</doc-anchor-trigger>
        <span>Winners don&#x27;t use AI</span>
    </h2>
</doc-anchor-target>
<p>Back in the day that was Daley Thompson saying <strong>Winners don&#x27;t use drugs</strong>, so to put a different spin on that switching drugs to AI as they are kind of similar as in if you rely on them to get through life then you will become a shell of the person you were. Not knowing how to use your own mind to get through the day and tapping into a new source of pure steriods aka AI.</p>
<p>Then again if you use it in moderation or for medical needs then I know it will help. Like since being diagnosed with ADHD I know without those pills every morning my brain does react differently, which then makes me act differently, maybe making rash decisions, or saying something before thinking of the impact of what you said and how you said it would have.</p>
<p>By no means am I encouraging anyone to use drugs especially illegal ones, but today we are going to use AI to hopefully give us a boost when we need one, more like a good cup of tea in the morning, nothing better to start my day than a cup of tea</p>
<p>I like to think of AI as a side-kick. Because every good superhero always has a handy sidekick to help them out. This is how I see AI, as a sidekick to help me when my powers are running out, or I need a second opinion on something. I do struggle at times to find the solution, but I know I won&#x27;t stop until I got that solution, and with the internet being as large as it is today, even with good googlefu searching techniques it can still sometimes take a very long time, to finally land on that webpage you were looking for that has a detailed solution to the exact same problem you are facing.</p>
<doc-anchor-target id="lets-get-coding">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#lets-get-coding">#</doc-anchor-trigger>
        <span>Let&#x27;s get coding</span>
    </h2>
</doc-anchor-target>
<p>A short while ago I spent £10 on API credit for <a href="https://platform.openai.com/">https://platform.openai.com/</a> to be able to write my own assistant. Sadly this did not quite go to plan as I didn&#x27;t read the small print, to realise I could not use the assistant to pull me back live results from the internet. However I ended up using google to build a custom search engine which then I could use PowerShell to use that and pull back the results automatically, then get AI to give me further insight on the results returned.</p>
<p>To follow along with this, you will need API access to the AI of your choice. I mean even if you are stuggling financially like I have through the majority of my life, to spend just £10 on something you will certainly get amazing value for your money compared with the cost of living these days. As in you could burn £10 on literally nothing these days, where-as the amount of tokens you will get in your API bundle for £10, will certainly be worth it in my opinion.</p>
<p>You might be thinking well I do not need to invest in API because the AI I use is free on the website. Yes that is true, but can you help automatically to influence the AI and automatically store the results it has produced as a .PS1 file in the directory of your choice?</p>
<p>Last night I got thinking about this side-kick approach, and thought of it from two different angles. The first being I might have some code, but I might want my side-kick to review and improve the code where possible. Or that same script might keep throwing an error that you want help on correcting, as you cannot quite figure it out.</p>
<p>The second idea was that maybe I don&#x27;t have the script written yet, but I have an amazing idea for a script, and I would like that side-kick to help make my idea become reality by writing me the code to do it.</p>
<p>Then if that code written for me does not work, and produces an error, I could then re-run the function with the first parameter set on providing the script-file and the error it gives to then focus my side-kick on producing me a fully working script.</p>
<doc-anchor-target id="code">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#code">#</doc-anchor-trigger>
        <span>Code</span>
    </h2>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock line-numbers>
<pre translate="no" class="language-powershell"><code v-pre class="language-powershell">&lt;#
.SYNOPSIS
Invokes OpenAI's GPT model to either refactor an existing PowerShell script or generate a new one from a description.

.DESCRIPTION
This function sends a structured prompt to the OpenAI API to assist with PowerShell script generation or refactoring. It supports two modes:
- **FilePathSet**: Refactors an existing script, optionally fixing a known error.
- **DescriptionSet**: Generates a new script based on a user-provided description.

.PARAMETER FilePath
Path to the file containing code to refactor (if applicable).

.PARAMETER ErrorCode
Allows you to specify the error you are getting in the FilePath you provided for your script

.PARAMETER Description
Description of the task for generating new code.

.PARAMETER OutputFile
Output file name for saving results (default is &quot;GPT_Output.ps1&quot;).

.EXAMPLE
# Refactor existing code in a specified file
Invoke-GPTCodeAssistant -FilePath &quot;C:\Scripts\OldScript.ps1&quot;

.EXAMPLE
# Refactor with Error Context
Invoke-GPTCodeAssistant -FilePath &quot;C:\Scripts\OldScript.ps1&quot; -ErrorCode &quot;AccessDeniedException&quot;

.EXAMPLE
# Generate a New Script from Description
Invoke-GPTCodeAssistant -Description &quot;Create a script that monitors disk space and sends an email alert if usage exceeds 90%&quot;

.EXAMPLE
# Specify Custom Output File to automatically save the script response provided
Invoke-GPTCodeAssistant -Description &quot;List all running services and export to CSV&quot; -OutputFile &quot;ServicesReport.ps1&quot;

.NOTES
- Requires the `OPENAI_API_KEY` environment variable to be set.
- Uses the `gpt-4o-mini` model via OpenAI's chat completion endpoint.
- Automatically extracts annotated code from markdown-style output.
- Designed for modular integration into automation pipelines or dev tooling.

#&gt;


function Invoke-GPTCodeAssistant {
    [CmdletBinding(DefaultParameterSetName = &quot;FilePathSet&quot;)]
    param(
        # FilePath mode: refactor existing script
        [Parameter(Mandatory=$true, ParameterSetName=&quot;FilePathSet&quot;)]
        [string]$FilePath,

        # Optional error code to tell GPT what went wrong
        [Parameter(Mandatory=$false, ParameterSetName=&quot;FilePathSet&quot;)]
        [string]$ErrorCode,

        # Description mode: generate new script from description
        [Parameter(Mandatory=$true, ParameterSetName=&quot;DescriptionSet&quot;)]
        [string]$Description,

        # Optional output file name
        [Parameter(Mandatory=$false)]
        [string]$OutputFile = &quot;GPT_Output.ps1&quot;
    )

    if (-not $env:OPENAI_API_KEY) {
        throw &quot;Please set the OPENAI_API_KEY environment variable before running.&quot;
    }

    $headers = @{
        &quot;Authorization&quot; = &quot;Bearer $env:OPENAI_API_KEY&quot;
        &quot;Content-Type&quot;  = &quot;application/json&quot;
    }

    # Build GPT prompt depending on parameter set
    switch ($PSCmdlet.ParameterSetName) {
        &quot;FilePathSet&quot; {
            if (-not (Test-Path $FilePath)) {
                throw &quot;File '$FilePath' does not exist.&quot;
            }
            $codeContent = Get-Content $FilePath -Raw

            if ($ErrorCode) {
                $userPrompt = @&quot;
You are an expert PowerShell developer.
The following script produced an error with the code: $ErrorCode
Please fix the underlying issue in this code and refactor it.
Add a synopsis at the top and include inline comments explaining each line.
Script:
$codeContent
&quot;@
            } else {
                $userPrompt = @&quot;
You are an expert PowerShell developer.
Please refactor this code, add a synopsis at the top, and include inline comments explaining each line.
Script:
$codeContent
&quot;@
            }
        }
        &quot;DescriptionSet&quot; {
            $userPrompt = @&quot;
You are an expert PowerShell developer.
Please write a PowerShell script that accomplishes the following task:
$Description
Include a synopsis at the top and inline comments explaining each part of the code.
&quot;@
        }
    }

    # Call OpenAI API
    $body = @{
        model = &quot;gpt-4o-mini&quot;
        messages = @(
            @{ role = &quot;system&quot;; content = &quot;You are an expert PowerShell developer and code reviewer.&quot; },
            @{ role = &quot;user&quot;; content = $userPrompt }
        )
    } | ConvertTo-Json -Depth 10

    Write-Host &quot;Sending request to OpenAI API...&quot; -ForegroundColor Cyan
    $response = Invoke-RestMethod -Uri &quot;https://api.openai.com/v1/chat/completions&quot; -Headers $headers -Method Post -Body $body

    $annotatedCode = $response.choices[0].message.content

    # Extract code from ``` if present
    $match = [regex]::Match($annotatedCode, '```(?:powershell)?\s*(.*?)```', [System.Text.RegularExpressions.RegexOptions]::Singleline)
    if ($match.Success) {
        $justCode = $match.Groups[1].Value
    } else {
        $justCode = $annotatedCode
    }

    # Save to file
    Set-Content -Path $OutputFile -Value $justCode
}</code></pre>
</doc-codeblock></div>
<ul>
<li><p>Parameter Sets: Uses [CmdletBinding()] with named parameter sets to enforce mutually exclusive modes (FilePathSet vs DescriptionSet).</p>
</li>
<li><p>Environment Check: Validates presence of OPENAI_API_KEY early to avoid unnecessary execution.</p>
</li>
<li><p>Prompt Construction: Dynamically builds a GPT prompt tailored to the selected mode and optional error context.</p>
</li>
<li><p>API Call: Uses Invoke-RestMethod to send a chat-style request to OpenAI’s endpoint with structured roles (system, user).</p>
</li>
<li><p>Markdown Parsing: Extracts code from triple-backtick blocks if GPT returns annotated markdown.</p>
</li>
<li><p>Output Handling: Saves the final code to disk and returns it as a string for further use or inspection.</p>
</li>
</ul>
<p>Hopefully this will help you in your PowerShell journey or help you build your own AI side-kick by editing the code above to fit your needs. I know this is not ground-breaking as in a worlds&#x27; first PowerShell AI assistant, but again will help you work smarter and not harder.</p>
<doc-anchor-target id="something-to-share">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#something-to-share">#</doc-anchor-trigger>
        <span>Something to share</span>
    </h2>
</doc-anchor-target>
<p>I still love piano rifts in dance music and how they used to send tingles down my spin when I used to go to raves, which looking back really does seem  a life-time ago. To show my love for dance music and piano rifts I put this tune together I hope you enjoy <span class="docs-emoji">&#x1F3B5;</span></p>
<div class="aspect-video w-full rounded-lg overflow-hidden mb-6 shadow-lg dark:shadow-lg">
    <iframe src="https://www.youtube.com/embed/XSKG5c6X3QU" frameborder="0" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen class="w-full h-full"></iframe>
</div>
<p>Until the next blog stay safe, and see you again soon.</p>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer id="retype-content-footer" class="clear-both">
                            
                                <nav id="retype-nextprev" class="print:hidden flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../whatif/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-base-text-muted">Previous</span>
                                                <span class="block mt-1">What​If</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../asciiart/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-base-text-muted">Next</span>
                                                <span class="block mt-1">Convert-​Image​2​Text</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div id="retype-page-footer" class="print:border-none border-t border-base-border pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between print:justify-center">
                                <div id="retype-footer-links" class="print:hidden">
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div id="retype-copyright" class="print:justify-center py-2 text-footer-text font-footer-link-weight text-sm leading-relaxed"><p>© Copyright 2025. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-sidebar-right-bg border-sidebar-right-border lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="retype-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "AI Assistant", level: 1, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
