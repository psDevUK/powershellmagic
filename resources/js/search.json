[[{"l":"Powershell Magic"},{"l":"Been on my mind","p":["So it has been on my mind \uD83D\uDCAD for quite sometime to build a new website, however I just never got round to it. So tonight whilst walking my dogs \uD83D\uDC15 with the mrs, I got saying how I feel the need to do a super amazing Powershell website \uD83D\uDCAF but just did not feel my mojo \uD83E\uDDE0 was in the right place. My mrs was like:","Just get on and do it, you always over think things"]},{"l":"More thinking","p":["This then led me to think \uD83D\uDCAD well I done a module for retype a while back this should be easy. Sadly seems that module is not working how it used to work since publishing it \uD83D\uDE22. Which got me thinking about how I should have put workflows into all my modules to make them easier to update. Like people say 'hindsight is a great thing' so as my plan A to build this site fell flat on it's face, I decided to go back to the source aka the official site for this great easy to use web designer. The Official Retype Site"]},{"l":"Reading research","p":["As I am that bit older now \uD83D\uDC74 I did further reading of the documentation, and when logging into the hosting site I use to publish personal websites,I discovered I had the same idea six months ago \uD83D\uDCC6 as I had setup this powershell magic domain, \uD83C\uDF0E but obviously the magic stopped there as never got round to publishing it. Having used Azure DevOps for nearly three years now with CI/CD pipelines to commit the work I do on the automation repository and raise a change notification for the change team, I thought this time round I would add in a github workflow to auto publish this site from my associated github repository. This should allow me to knock more pages together in shorter time and hopefully keep you the audience like your favourite TV \uD83D\uDCFA show or comic just hanging to see the next episode, or reading the next title to be published.","Yes I am still reading comics \uD83E\uDDB8 so lets do what I did before and add some lovely pictures and get talking Powershell. This as it says on the picture is The Magic Order and is a totally epic comic written by Mark Millar, currently there is five series of this out, and will hopefully come to Netflix soon."]},{"l":"Previous Powershell blog","p":["My previous blog site (link at the top of the page) led to some amazing things for me, it helped me secure a job, it got me invited to do some Powershell talks to live human beings who attended. I also got to go on the Powershell podcast, I even got a call from Jason Helmick from the official Powershell Microsoft team. I also got to speak to a huge idol of mine Chrissy LeMaire who is like the most awesome person I know (apart from my mrs that is) and life was going great. Sadly I had some personal issues and then basically went and hid in a cave all this time being a hermet \uD83D\uDC1A. I have just been so focused on my job and wanting to give 100% each day that I neglected the blogging that I was really enjoying doing. I stupidly \uD83E\uDD21 also turned down book offers to author a Powershell book from several different publishers (major regret \uD83D\uDE2D) just because I wanted to be 100% focused on my job, and to provide for my family.","My Previous Blog Site","If you have not visited my previous blog site, trust it's full of Powershell \uD83E\uDD53 Magic to hopefully inspire you"]},{"l":"New location","p":["Just under a year ago I moved \uD83C\uDFE0 house to a more remote location in the UK, which to be honest feels like I am on holiday everyday as the surroundings are so beautiful, and only a few minutes from the sea. I find the ocean \uD83C\uDF0A so therapeutic to listen and look at the big waves crashing in, I go to the beach everyday to get my fix of mother nature \uD83C\uDFD6️. Then just as I am like I finally done it, life is feeling really good, I get informed that my work wanted to do mass redundancies in IT due to the merger that was done with another company. Despite numerous people telling me I am safe because I am the only person who does x, y and z at work sadly that does not seem to be the case and I felt like this lady at the front of this comic when having the consultation that I was not coming out of this without damage being done:"]},{"l":"You made it this far","p":["If you survived reading this landing page congratulations, trust the rest of this site is not about my life dilemmas and will feature lots of \uD83D\uDE0E awesome Powershellness that should leave you feeling \uD83E\uDD2F refreshed. Until the next page comes out, thanks for visiting and hang tight and the code will be coming in the next update."]},{"l":"Something to share","p":["I can however share with you my latest youtube video I made, working on some oldskool house vibes if you like this video the by all means feel free to subscribe as I have been trying to make my own music for a little while now \uD83C\uDFB5"]}],[{"l":"Powershell Magic","p":["As promised in the landing page this time we are actually going to do some powershell magic which to me is being able to provide a script from scratch to deliver the solution to the given problem."]},{"l":"Thinking...","p":["I firmly believe in understanding and thinking of how you will provide a solution to the given problem, and to also have a back-out plan in-place if any changes are being involved. I do not influence violence by any means as the solution, but as the picture above shows, this lady has thought her way out of the problem she was presented with."]},{"l":"Normal rules I follow","p":["Understand the problem\uD83D\uDE15 if you do not understand the problem ask for it t be explained again. Then look to apply a solution which can be re-used to fix the given problem. Normally this involves writing a function and providing certain criteria as parameters, so that you can then change the values of those parameters to meet the given problem you are trying to fix.","Do not re-invent the wheel\uD83C\uDFA1 as in you could potentially go off on a mission to re-create something out there that already exists. So I strongly advise you at least check out the Powershell gallery for any existing modules that may already exist to help you solve the scripting quest you have been presented with. You could also use code specific sites such as GitHub to see if something exists or something to inspire you. Yes at school you may have got yourself into big trouble as this is technically plagiarism but we are not at school anymore.","Do not spend too long looking for something else⏰ to solve the problem for you, as in if you could do the task manually in ten minutes but you spend three hours looking for that solution, then to me that is not time well spent and being efficient. I tend to limit my time reasearching to a maximum of twenty minutes, as I knew this particular task would have taken a lot longer doing this manually, so even if I did not find any modules or scripts of interest I have only invested a maximum of twenty minutes of my time.","Get cooking up a solution\uD83C\uDF73 as in start coding the solution to the problem, I like to add comments so that if someone else should need the code, or you show it to someone who does not fully understand code, they should be able to understand the comments you have made and read through those understanding what your script is going to do and the order it is doing it in."]},{"l":"What was the problem?","p":["Hopefully as the link suggested the issue was numerous zero-day threats discovered from an article my boss had read Security Article My boss wanted me to verify that each of those zero-day threats we had protection against in SCCM. Although SCCM is amazing in deploying various items across you network, I do find it extremely point and clicky and sometimes over-kill to get the information you are after. So I knew about the Configuration Manager module, as I have used it to build my own stream-lined SCCM dashbaord. However how could I get all the CVE information from the website I was provided a link to and then double check that the fix had been setup in SCCM?","This is where you use twenty minutes of your time wisely, which led me to a module I had never heard of or used before MSRCSECURITYUPDATES","Using this module, I could reference any given CVE threat, then obtain the KB article number which has been released to fix that specific CVE threat. This would save me a lot of time from trying to obtain this off of the internet visiting numerous websites for each CVE, and again save me a lot of point and clicking. \uD83D\uDC01"]},{"l":"What was your solution?","p":["Although I did mention functions in my previous normal rules I follow, as this was the first time of being asked to provide this type of information in the two years and eleven months I have worked at this company, this did more seem like a one-off request. I normally write the script, then if I see that the script could be useful say to check this on numerous computers, and other filters, then yes I would most certainly make this into a function so that you do not have to manually edit the script each time. As this was a one-off request then I decided producing a script to provide the answer of yes the patch is in SCCM and has been deployed or no these CVEs are not currently protected against in SCCM was a good enough solid answer to the problem I was provided with."]},{"l":"The end solution"},{"l":"Thank you","p":["Again thanks for your time reading this article and hopefully this has given you some ideas \uD83D\uDCA1 in your head on fixing a similar issue you may have been presented with at work, or just little tips used to be more effective in providing a scripted solution to any given problem. In total this took less than an hour to produce from the initial question being asked, and I was certain that the information returned was correct. Thankfully all patches did exist in SCCM and that was that."]},{"l":"Something to share","p":["Recent times have been pretty emotional for me, especially with more recent news. I do find music can help, and even better if you can put a tune together to show how you are feeling. so I hope you enjoy this emotion tune I made \uD83C\uDFB5","Until next time, stay safe and see you again soon for another Powershell solution \uD83D\uDE01"]}],[{"l":"Powershell Magic","p":["Hello folks, yes this blog is a few days later than planned, and well there is a good reason for that. Unfortunately I was really sick \uD83E\uDD2E all this weekend, but prior to that my wife had it Thursday night, then my youngest daughter, then my eldest daughter, then second eldest, then my third youngest daughter, then my second youngest daughter then I finally got it. So was a very unpleasant twenty hours of that happening. Guess when you got a family my size and one of you gets ill then you are all bound to get it."]},{"l":"Not feeling well","p":["Top Tip: Wearing a mask whilst puking your guts up is not a good idea.","Moving on swiftly let us talk about some more Powershell magic in applying a fix to the problem."]},{"l":"What was the problem?","p":["So the issue we are going to discuss is duplicate assets in Tenable. I know at first you may think well that has nothing to do with Powershell, and you are correct. However I provided a solution using Powershell and the Tenable APIs to solve the given issue. Yes this is a problem that seems to have been talked about for years on the internet, but after spending time to look into the issue to see if there was a magic \uD83E\uDDD9 hotfix, or patch to apply to Tenable to resolve the issue and finding one did not exist. Then looking on various forums and seeing other Tenable customers were also suffering from this same issue, but no definitive resolution on how they solved it.","Example of this problem","I did find that someone had set a particular registry entry to read-only which then meant Tenable had to use the next criteria to check if the machine is unique. This did make sense in my opinion but I had been informed that, that method had already been tried and did not work."]},{"l":"Contact the vendor","p":["I wanted a proper Tenable solution to this, so I raised the support call with Tenable ☎️ who could confirm that the scanning to test if an asset was unique or not was done in this particular order (most useful information I was provided with):","Tenable UUID","BIOS UUID","MAC Address","NetBIOS Name","Fully Qualified Domain Name (FQDN)","IPv4 Address","As the first option is checking the registry again that made sense to set that as read-only to force Tenable to try the next object in the list. Once again I was denied.","Although I had supplied numerous proof to Tenable that these duplicate assets existed, they wanted access and the passwords to look at the database. I asked for this information but as I was not supplied it from the securty team Tenable closed the call after 7 days of no reply.","It did seem a bit \uD83D\uDD29 nuts that Tenable could not supply a fix to a problem that has existed for at least five years, and just ask for access to your databases, instead of maybe providing checks to do in the database. Or checking specific scan settings, but sometimes it is what it is. Providing not so awesome support to paying customers"]},{"l":"Plan B","p":["So although plan A did not go as planned, as in I was hoping the vendor would supply a permanent fix to the issue. I still had this issue with numerous duplicate assets in Tenable which I was also sure was affecting the CES Cyber Exposure Score by making this inflated as it was counting all the duplicates as unique assets, so any threats these duplicate assets had were being shown numerous times. \uD83E\uDDEE","I had spent time \uD83D\uDD57 looking at a solution on the WWW and found only a potential solution to fix the issue, which I was not allowed to try as apparently it had already been tried. I had reached out directly to the vendor expecting some patch or specific setting which could be changed, but again the support I received, did not provide any information to solve this \uD83D\uDE22 and you are still expected to fix the issue, seeming as you were the one who identified it.","I am not to good at planning things in a diagram format, but this was the plan in my head. So my idea was grab all the assets that are in Tenable, dump them to a CSV file, then use a parameter to seach for particular naming conventions, group all those assets, sort them by descending order and skip the first result.\uD83E\uDD2F Then all that are left in the group are duplicate assets that were not the most recently seen, meaning it was a stale duplicate record. Provide your own solution to a problem, making sure it works"]},{"l":"Research","p":["Despite the support I received from Tenable not being the best, as no answer could be provided, just more questions being asked to me. Tenable does have decent documentation on their API and how to use it:","Tenable API documentation","There is quite a bit of information displayed here, due to there being a lot you can do in Tenable, and this provides the API way of doing each of those things. As hopefully you realise that I am not a \uD83D\uDC2D point and click type of guy.","After looking at this documentation \uD83E\uDD71 I saw there was a method for exporting all the assets, and that is all I really needed as my idea I explained earlier would dump this information into a CSV as a lookup table for particular assets."]},{"l":"Time to get cooking","p":["\uD83D\uDC68‍\uD83C\uDF73 Unlike my previous post I wrote about, I knew from the get-go that I would most certainly be using this solution more than once to fix this issue, as sadly Tenable could never provide an answer to the problem. As I know it was going to be used more than once, this to me made it worth while into making this into a function. Maybe even two functions, one to gather all the Tenable assets, then another to find the duplicates.","The above function will gather all the assets registered in Tenable and place them into a CSV. I know I am missing a help section I promise to do better on my next post, but as I was not publishing this anywhere, and I was going to be the one running it, I thought I should remember something like Get-TenableAssets -OutputCSV C:\\Temp\\TenableAssets.csv yes I know I could have used a more standard parameter like path or something similar, but I decided that OutputCSV was good enough for the job. This was my function after all. The more assets you have the longer this function will take to run.","Now I needed another function to actually sort the duplicates from the CSV file. Yes I know excel has this built-in to highlight duplicate values, but you would still then need to extract the UUID of the asset to delete, and I did not want to delete all duplicates, as I wanted to keep the one unique one, which would be the most recently seen by Tenable."]},{"l":"Solution","p":["By extracting all the Tenable assets with Get-TenableAssets function which I only needed to run once. Then I could use the second function Get-DuplicateTenableAssets to search for various naming conventions that I knew duplicates fell under. Although I did not lower the CES as much as I might have hoped, this did go down by at least 15 points. If you work with Tenable you may also know that say fixing 500+ assets with a problem, might only lower the CES score by 1 point. When I looked at it like that it did make me feel a bit better, and also proved to the doubters in the security team that the duplicate assets were indeed inflating the CES within Tenable. \uD83D\uDCA5"]},{"l":"Something to share","p":["Yes it is more music I want to share that I put together. I am sure that if you work in IT you most likely played arcade games or oldskool console games when you were younger. So please enjoy this chiptune inspired music I put together \uD83C\uDFB5"]}],[{"l":"Powershell Magic"},{"l":"Welcome Back","p":["Today we will cover another tale from the depths of the IT world on how Powershell can save your \uD83E\uDD53 when being tasked with a problem to solve. To me the main problem is, the \uD83D\uDC2D and a crazy amount of sysadmins out there prefer to use this \uD83D\uDC2D to point and click there way through any issue. I think some people must see it as their sword to fight off all the problems swaying it about all day and using a lot of the working day using this \uD83D\uDC2D of theirs to click there way through any given problem.","Do not worry people I have my mighty point and click mouse to save the day","People the year is not 1995 anymore, it is 2025 and to me the \uD83D\uDC2D is just a big drain on the time it takes to fix the problem. Plus leading to possible errors clicking on the wrong item or object and then leading to more delays or possible issues. Then with the amount of servers some people look after, like myself this number is a bit under 3,000 then to say fix even 200 of this number with a specific fix taking the point and click route is just going to take forever."]},{"l":"Microsoft Windows Unquoted Service Path Enumeration","p":["I will be looking at a particular threat that exists out in the wild-west of Windows and how using a bit of \uD83E\uDDE0 power and the mighty Powershell to resolve this issue in a flash. More information on this threat can be found right here:","Nessus Plugin ID 63155","Again what I do not understand is for a paid for product like Tenable they do provide you with a solution for most of the issues, but the solution is like so half-assed in my opinion just like this particular issue we are focusing on today. Like if this only affects Windows boxes, and requires the same fix to be applied as in placing quotes around the service path which contains spaces, then why the heck does Tenable not provide a Powershell solution to the problem? As all Windows boxes these days run Powershell, and even if your company is still running on 2008 servers or something crazy like that, you can still use Powershell.","The only benefit of the paid for version of Tenable is that it will identify the service at fault, allowing you to specifically go to that particular area. I do not know how much Tenable costs, but it does seem bonkers that a massive anti-threat provider cannot provide the solution to make things easier for sysadmins out there who might not be able to write their own non-point-and-click solution to the given problem."]},{"l":"Break it down","p":["No I do not mean perform run DMC dance-off moves I mean lets break this problem down.","It affects Windows machines","It is related to a service having spaces in the path","It will always be in the same registry location","Armed with this information and a little bit of thinking, this seems a perfect time to cook up a delicious script to fix the issue. So I might have only 20 machines to fix, but setting up remote desktop to each of those machines, then logging on, then opening the registry, then navigating to the specific registry area, then tracking down the exact service which needs quotes around it, all seems way over-kill. Especially if it really affects say 200 machines now your looking at spending possibly days doing the same mind-numbing point and click routine. Not good use of your skils or \uD83E\uDDE0 power.","A bit like riding a super-powered bike, whilst scraping a ninja sword along the ground. Total over-kill except this looks super-cool over-kill, you pointing a clicking your mouse will never look this cool"]},{"l":"My Solution","p":["So for a long-time Powershell has supported the Invoke-Command cmdlet to make life less point and clicky, by allowing you to run commands against remote computers. However this does rely on you having certain 'things' configured for this to happen correctly, one of these being that port 5985 is accessible on the remote machine from the machine you are running these commands.","I also built my own Tenable dashboard, to make it easy to find all machines with a particular pluginid threat, and the ability to the export those machines to a CSV from the mighty Powershell Universal which is an AMAZING product. So I visit my dashboard I type in the plugin id for this problem which then gives me all the affected machines. I then export that list to a CSV so I have an array of machine names to apply this given solution to.","Going to use a handy function I use in a lot of my scripts when running commands remotely against remote machines to make sure the machine has the port 5985 open before trying to invoke-command as again this can slow down your script considerably waiting for this to time out, when you could just do a simple check prior to make sure that the required port is open to allow remoting.","The script starts off defining this handy function Test-Port which will then load it into memory to allow you to use it throughout that powershell session you are running.","Next I am defining the array of Windows machines this fix needs to be applied to which was gained through Tenable.","As the exact same thing needs to be done on each machine although the service name may vary I took the approach of using a regular expression with the knowledge that the services in question are running off of the C: drive. This allowed the solution to not rely on me having to specify a specific path, and use a more one-size-fits-all approach to the method.","Any unquoted services found, will then have the needed speech quotes put around them. \uD83D\uDCA5","Mission Accomplished\uD83D\uDE0E"]},{"l":"Thank you","p":["Thanks for taking the time to read this blog, and if you work for Tenable and you need someone to provide easy-to-use solutions to the vulnerabilities your software exposes then please get in touch as looking for new job opportunities. On that note, will leave you with some chilled out music I made a little while back."]}],[{"l":"Powershell Magic","p":["So been a few mental days lately. One of the Shar-Pei dogs I own gave birth to 7 amazing puppies 5 boys and 2 girls. However had to take two of the boys to the vets due to their eyes not opening, and I think these two might need tacking to solve the issue. I am still waiting on the vet calling me back from the visit this morning.","Everyone loves a puppy picture, so here are the puppies I have","Then since moving to the lovely North-Devon my car seems to have collected a number of scratches and chips. So trying to save a few quid and be a jack-of-all-trades I decided instead of paying a garage an insane amount of money to fix them I decided to do it myself. Well I can see why the garage charges what it does, as you do need a lot of skill and time to get the perfect finish. As although the repair work I done looked good, I am a perfectionist, so decided to sand it down a bit more, which then led to me being the karate-kid last night doing 4 hours of wax-on and wax-off to buff out the dullness of the sanding I done.","I was so aching from 4 hours non-stop T-cutting my car, but thankfully the big dull patch of paint is looking pretty damn good, not perfect yet, so may go for some extra wax-off and on traininig after work today and enter a karate competition next month or something \uD83D\uDE04"]},{"l":"Up your skill level","p":["If you have seen my LinkedIn profile of late, you will know I am looking for new work opportunities. Even though this is like the worst time to be looking for new opportunities due to all the mass redundancies happening now, I do not want to be in the same situation some people are reporting they are in which is near homelessness.","Having been looking for work, and reading some of the skills and knowledge some companies are expecting from a single person also seems a bit insane. Like I know it is insane as I been in the industry for 25 years and I know it is not possible for just one person to have all the skills and qualifications some companies are looking for, that they list you need for a particular role. I have personally never met or worked with someone with that many qualifiction or knowledge.","Or you may have a douchebag manager who has not allowed you to explore and use your skill-sets to the fullest at the place you work, and your company or current job may not use all the latest and greatest IT tools or software. Again you may have had a terrible manager who has only tried to throw you under a bus by giving you random server issues to solve as no-one else has been able to solve them, not allowing you the time to look at building a new learning journey into things that may interest you. You might have been promised by your company multiple times that you would get training and never received any training, other than completing compulsary company courses that may not have anything to do with your job.","If any of the above applies to you, then I have some good news for you Microsoft has your back on all the IT training you could wish for. To make it even more amazing these training courses are totally free and if like me you got 5 daughters, the mrs, 3 cats and 10 dogs all relying on you bringing home the cash, then free is like one of the best things out there.","Where can I find this free amazing Microsoft training?","At this present moment on this day: There is a huge amount of 4,476 courses to choose from."]},{"l":"Badges","p":["As a boy scout Pranky from Hyde Street loves his badges","After completing these you either get a trophy or badge to recognise you learnt that particular learning path or completed all courses in that module. We all know kids love badges and stickers, and well if like me you may also think they are still cool even as an adult.","I want to be able to show the companies I am applying to work for, that I am that perfect candidate who really does know everything they have listed in the various skill-sets on the required job form. To help me be that candidate I have been ploughing through various courses and after 10 days of doing this I currently have 34 badges and six trophies. \uD83E\uDD73","I know you might be thinking \uD83E\uDD14 dude I read your blogs to learn cool Powershell stuff, and get inspirations for new ideas for scripting","Please be patient I promise there is a problem and Powershell solution in this blog post.","Now I got nothing against this Microsoft learning website, infact I \uD83D\uDC96 it hence I been writing how cool it is. However, looking at the badges or trophies you have earnt, the cards displaying this information only go up to 3 cards wide. So on my \uD83D\uDCBB laptop screen I can only see a maximum of 9 achievements at one time.","The maximum badges I can fit on screen","I wanted to display all my badges as one long image to post on LinkedIn, to spread the word I am now the badge man to employ. I took a total of 4 different snips but now needed to magically glue them together so-to-speak to great one long super cool badge looking achievement of the last 10 days."]},{"l":"Powershell to the rescue","p":["So I decided to let Powershell combine the images for me vertically to allow me to have one long image as the end result. Thinking 3 parameters should do the trick wrapping this into a function, as I know when I earn some more badges I will want to achieve the same thing, so need something to re-use, so lets make a function to save the day. We will also need to accept an array of images to combine together, and finally an output path to save the final stitched together image.","This would save me looking on the web to download some software to do the exact same thing, and give me a tool I could re-use or potentially add new parameters to, or expand the ability of what the function actually does. Right now I just need to magic up some code to make this happen.","Please follow the Powershell verb noun naming conventions to follow best practices when writing functions, it will also make it more usable to the community should you deicde to publish it in a blog, or on the Powershell Gallery as a script or module.","This might not be the best solution out there but it worked, and I will be re-using it for when I have earnt some more badges.","To make it clear on using this, you would need to do something like:","Yes I know more error handling could have been implemented as in checking that the image paths you entered exist on the system before running all the code, but as I had something working, I was happy with the results, and it ticked all the boxes for what I wanted."]},{"l":"End result","p":["Look at all these badges in 10 days!","Maybe I could look at implementing a width to make it a bit neater, but I was happy with this, so happy that I wrote this blog to hopefully inspire you that anything is possible with Powershell if you just add some \uD83E\uDD53 magic to it \uD83D\uDE03","Pranky putting his skills to use like his knot tying badge"]},{"l":"Something to share","p":["Not made any new music for the last few days as been real busy, but this was the last video I uploaded to YouTube I hope you like \uD83C\uDFB5"]}],[{"l":"Powershell Magic"},{"l":"Puppy update","p":["So as mentioned in my last blog a couple of the puppies seemed to be having issues opening their eyes, which is common in the Shar-Pei breed, as they are so wrinkly basically their eyelids can roll in on the eyes, and needs immediate attention, as this can lead to more problems the main one blindness.","My wife and I took two to the vets immediately, not my local one as they had no appoinment slots, only to be informed that they were fine and was sent home, and the vet mentioned eye drops if it got worse. Less than a day later could see the pups were having discharge from the eyes, so phoned vet back. Only to be told that the vet we saw was now on holiday, and no notes were left about the eye drops, which meant another consultation fee to pay and a different vet to see in my local vets.","Again seemed pretty pointless, as they did not know what eye drops to prescribe and they needed to contact this vet eye specialist in Bideford. My wife got on the case and contacted them directly, and another consultation fee and another visit. By now my wife had noticed that another pups eye had closed, just the one which was previously okay. So off we went to the vets for yet another consultation, but this time hopefully an answer to the problem. So in total all these visits and the eye tacking operation which was required has now set me back I think £1,247 in total. So very grateful I have a job to have been able to pay for this, but yeah an unexpected cost which I could have done without, but I love my animals as they are part of the family, and although I plan to sell these pups minus the white one with a cone on it's head, as I do not think 10 dogs in the house is practical I still love them to bits and want the best for them.","Got 3 cone head pups now","So thankfully after all the drama of like visiting 3 different vets, finally got these little pups to the right vets who were amazing with the work they done, as they are only 3 weeks old."]},{"l":"Background to issue","p":["Right now I got all my puppy problems out the way I can now focus on writing a new problem and Powershell solution to that problem. The background to this problem is the MemberOf tab within a user account in Active Directory","Well that is not a problem in itself, infact it is really handy to show you would groups a particular user is a member of within Active Directory. Not long after I started this job, I realised this is a big company with thousands and thousands of users. To further complicate things this is the first company I have worked at which uses Role Based Access Control aka RBAC. So although the 200+ scripts I look after which do all the on-boarding for users sometimes the data that these accounts are created off could not hold the right information (I have no control over the CSV data) and like the saying goes bad data in bad data out Despite raising this numerous times to fix the underlying issue, the people in-charge of the spreadsheet obviously like to keep me on my toes. Also as not all people in the company might not appreciate the rules configured for RBAC you could have HR change loads of peoples departments, or job titles. This then means that those people are automatically removed from RBAC groups as they no longer meet the given criteria to be in that group. This then leads to being asked why user A can still access what they need but user B can now no longer access the things that they used to be able to access which was the same as user A","Although I am not office based I know that people will look at the MemberOf tab in Active Directory with two user accounts side-by-side and try to do a spot the difference between them. Due to the size of the company I work for also adds a crazy amount of Active Directory groups. So this then becomes a mission to identify the missing group or groups due to the size of the lists shown.","Do not let spotting the difference lead to situations like this"]},{"l":"What was the problem?","p":["Within the first month this problem had presented itself a few times, so wanting to make a good impression and solve this easily going forward I cooked up a very basic function. Honestly I have now used this hundreds of times, and given it to numerous people in numerous IT departments as it has saved my \uD83E\uDD53 so many times when I get asked about why this account cannot do something when another account who should have the same access can.","Put simply, states: “the simplest solution is almost always the best.” It’s a problem-solving principle arguing that simplicity is better than complexity. Named after 14th-century logician and theologian William of Ockham, this theory has been helping many great thinkers for centuries.","Although I was not thinking good old Occam's Razor when I did this, I was thinking that this simple solution would solve this issue in no-time, and it was so simple I kept it as a basic Powershell function, sometimes the simple solution is the best solution. Just crazy how many times I have used this, and even the same people asking me who I have previously given this same function to still ask me, and I run this function, then the issue is revealed which group or groups are missing from one account that the other account has."]},{"l":"Get-ADGroupDifference","p":["You may have noticed that I use the $Global parameter here to store the outcome of the display. I also use the Out-GridView cmdlet to allow easy viewing, sorting and filtering of the data presented."]},{"l":"Bonus solution","p":["The bonus feature is putting this to even more use. If you have managed Active Directory you most likely have been asked that you want userB to have the same permissions or access as userA now I know a lot of people do tend to just copy accounts, but that is not best practices as you do not know exactly what you are copying, and if userB account already exists in Active Directory you do not want to be deleting that account and creating a new copied account as it will get a new GUID and will not match the cloud linked Active Directory account anymore and well it might seem a simple solution, but in this instance it is most certainly not the best solution or idea.","So to achieve being able to say automatically give userB everything that userA has we can simply add a few more lines of code:","This time a double-whammy solution to the age old problem of differences in Active Directory accounts. I know I could have even jazzed up this function for this blog, but it is what it is which has become my saying of late with all the unexpected news I have recently had."]},{"l":"Something to share","p":["Again I need to make some new beats but life has been rather hectic of late, so I hope you enjoy this tune I made not so long ago \uD83C\uDFB5"]}],[{"l":"Powershell Magic","p":["Ilfracombe"]},{"l":"Family","p":["Was very lucky to have my mum and dad come to visit over the last few days. I took time off work to spend with them, and was really a pleasure to see my parents. I like to keep in contact via phone, but normally it gets to 10pm or 11pm really quick, and I tend to then be thinking well I do not want to wake them up just to be saying 'hi how are you' when they could be fast asleep.","I know my wife regularly speaks to my mum on the way home from dropping off the kids at school, but like the saying goes","You don't know what you got until it's gone","I wanted to make and spend as much time with them as possible, as it did take them five and a half hours to travel here. Before moving here to lovely North-Devon I was only living a few miles away but now that has increased to 180 miles away.","Just saying if you got family you might not have spoken to in a while, make that call (at a reasonable time) and see how they are doing","It's good to talk","Inside one of the UKs oldest working lighthouses I visited with my dad"]},{"l":"Podcast","p":["So I was lucky enough to be invited onto Ryan Yates new podcast series he is creating. More information on Ryan can be found here:","Recent blog Ryan done","I have known or known about Ryan for a good number of years, but never had the opportunity to link up with him. A short while ago I did have a good hour chat with Ryan over teams, and we seemed to click and was mentioning how I wanted to get blogging again, and he was full of support and useful ideas.","Then he posted about doing a new podcast series, and well that landed me with an invitation to speak about the new online safety act that has been implemented in the UK to verify you age on certain websites, rather than clicking the button to just say you are 18 or older. Personally this change has not affected the way I use the internet but I know recently after being implemented there was a petition of over 400,000 people requesting it to be revoked.","It also came to light that VPN software was now the most popular downloaded software on smart phones. Now have a short think to why that might be. Yes because it will allow you to bypass the new online safety measures for the UK as your browser will think you are in another location. This got me thinking about making this into an image. So with the help of AI and me describing the type of image I wanted, I cooked up this idea for a new kids book:","Possible best seller","I mean I totally understand why the Government wanted to implement this, but as I was explaning to Ryan I am either really lucky, or I done a decent job bringing up my 5 daughters as they are all still innocent, and would not want to surf the web to look at the type of things that have these new online safety measures put in-place. Kind of feels like the UK is being controlled by a nanny state, where like at school you were always being told","The minority spoilt it for the majority","I also believe the UK has far bigger problems right now, than kids looking at things they should not be, which then made me think about another possible book to write:","Another possible best seller","To me it should be the parents responsibility to educate your child on these matters, not the government. Also if you know that VPN software is currently the most popular app on smart phones right now in the UK, then you know there is shed loads of people, children or adults are bypassing this new law. You also know things can spread extremely quickly around schools so I am pretty sure this is another epic Government failure of wasting tax payers money to fund a duff project. Like what if the websites get hacked that contain all the people who have verified themselves along with card details. Or what if there was rogue VPN software being released that was now storing all your internet activity and passwords.","Please listen to the podcast when it is released and I will be updating this page with the link."]},{"l":"This blogs problem","p":["Right time to get talking about another problem I was faced with and using the mighty Powershell to solve that problem and automate the solution. Again this is not send a person to the moon type of complex Powershell solution, but it did exactly what I needed it to do, and was accepted by the external audit company as an official answer.","So I mentioned it in that last line, but this was to do with an external audit I was requested to participate in, and to prove without a doubt that the company I work for was following all processes and procedures laid out, in order for them to pass the audit. To my suprise the auditors were requesting screen shots of all the data that they wanted, as well as the method used to obtain this data.","Repition right there, having to take multiple screen-grabs of the code used, and the data being produced from that code. Or even worse doing the task manually and having to supply thousands and thousands of screen-grabs. Then labelling them all, then saving then rinsing and repeating the same task. Not only is this mundane work to do, to me it is not making the best use of your time having to faff about with snippet or another tool, then taking the time to name and save each picture. Also when doing a very mundane or repetative task, I believe you are more likely to make mistakes, as we are only human at the end of the day. So although I could have exported all this data to a spreadsheet, that sadly seemed a non-viable answer to meet the criteria of screenshooting all the evidence. Plus with the amount of data being returned I would not have been able to show that in a single screenshot.","Nothing is impossible to do in Powershell. I have strongly believed that since reading my first few Powershell version one books I bought when trying to self-learn this language 15+ years ago. I really did have my mind blown on what you could do with this new terminal shell Microsoft had released and it still blows my mind today with things being done with Powershell. So as mentioned the first thing I always think about is solving that given problem with Powershell as it can do anything in my personal opinion.","Looking at previous audit data supplied, there was screenshots of the script, then the output of the terminal containing the data returned from the script. So right then had a light-bulb moment where I figured all I needed was a Powershell method of taking a screen-shot of the current active screen with the script running."]},{"l":"Solution","p":["I needed to obtain all active users within Active Directory and display the output with certain selected criteria for each user. If I was a non-coder point and click person this would have certainly taken longer than a day to produce. So I knew I could easily code what was being requested, but then I needed to figure out a way to be able to take a screen-grab and automatically save that information to a pre-defined path. I did look on the Powershell gallery to prevent re-inventing the wheel, and also a small amount of time was spent on the internet. As I could not specifically find exactly what I was after, I was inspired enough by data that I found, and as I knew I needed to answer a lot more audit questions, this then made sense for me to create a function by the name of New-Screenshot to enable me to easily use this capability of automatically taking screen-grabs of the requested data, meeting the requirements set out by the external auditors. I have added enough comments in my code to walk through the logic of this script, and what certain bits of the code are doing if you do not fully understand it.","I appreacite this is not a cmdlet standard function to allow you to do this, but it is all Powershell running and working with the assemblies loaded allowing you to then automate other aspects of the Windows operating system with ease. No I do not use assemblies in my code on the normal day-to-day scripts I write, but for this particular scenario this seemed like it was the only way to make it all work in Powershell. I am still amazed all this only took 36 lines of code, which includes a lot of comments, this could be halved or less if you compacted the code formatting and got rid of all the comments. Now that to me is very powerful in not a lot of code used.","This then ticked all the boxes from the auditors point of view, and then allowed me to re-use this function, and create a script to call this function like above for the other questions I had to answer. Without this particular approach even running the powershell script at the bottom, would have involved taking over 40 different screen shots. Not a task I wanted to do, plus this now saved me having to take any screenshots manually for the rest of the audit questions. To me this was mission accomplished, and all my data I submitted was accepted from the external auditors using this method, which also saved me a shed load of time, and made sure no mistakes happened like forgetting a screen-shot, or taking the same screen-shot twice or something similar.","He-Man was a big influence on me as a child, I always wanted the Power of Grayskull, although I never obtained the extremely ripped muscles of He-Man, I have something more powerful...I now have the Power of Powershell"]},{"l":"Thank you","p":["If you managed to read all this without falling alseep then a massive congratulations, you made it to the end of my blog, about a boring task being given some Powershell \uD83E\uDD53 magic. So to bring you back awake please checkout this tune I made last night \uD83C\uDFB5","Until next time stay safe and take care."]}],[{"l":"Powershell Magic","p":["An awesome comic about a computer related threat"]},{"l":"Scheduled Tasks","p":["So I am sure you have used or know about scheduled tasks. They have been a part of Microsoft Windows built-in features for years and years, I can even use the word decades for how long this has been part of the operating system. Personally I think they are a bit old-skool and there are many new ways you could implement scheduled tasks without having to use scheduled tasks.","One thing that automatically springs to mind is Powershell Universal by Ironman Software which has something built into it, which is like scheduled tasks on steriods. I love using Powershell Universal to be able to automate given problems, but also being able to produce a beautiful looking webpage from your powershell code. It really is amazing so check that out if you do not know about it, I seriously think this will blow your mind on what you can do:","Powershell Universal","When I started this job I soon found out that all the automation being done was using scheduled tasks to run certain scripts at certain times of the day. Personally I had never seen so many scheduled tasks setup like this, I mean there is just under 300 scheduled tasks all running which I have been the sole person managing for over a year, plus doing all the other things that come my way like projects, service now tickets, audits, security work. It keeps me busy and puts food on the table for my family and a roof over their heads which is the main reason I work. To be able to provide for my family."]},{"l":"What was the problem?","p":["Not that long ago I was informed there was a security threat and certain passwords needed to be changed immediately within Active Directory. One of the accounts which needed this doing was the service account which runs all of the nearly 300 scheduled tasks. As soon as I was informed about this change I also knew that the ramifications of changing that service account password would also mean that nearly 300 scheduled tasks would all need the password updating in order to carry on working. If this was not done, then the scheduled tasks running would carry on using the last inputted password, which was not going to be valid anymore as the password had to be changed to resolve the security threat.","WorldTr33 by Image Comics is a great read about a security threat spreading by mobile phones"]},{"l":"What was the solution?","p":["So this is like a no-brainer to me, I know I needed to update all the scheduled tasks to be the new password that was being set. I also needed to make sure that the secret server also had all references of this account and the password updated to, but this particular blog is just looking at the scheduled tasks.","Again I am kind of laughing as I write this as I know so many Windows Admins would just choose the point and click route to update each and every scheduled task, but as I had nearly 300 to do, there was no way I was wasting my time doing this, as I firmly believe in working smarter not harder and providing the best you can for the company you work for by not wasting a whole day or more doing mundane tasks the slow point-and-click way. To me that is like putting your feet on the desk and picking your nose all day, as in not making the best use of the skills and time you have.","I know far too many people choose this route of point-and-click because it is the way they have always done things, or might think it is too complicated to code. Well look, I only got GCSE's to my name, I never went to University and I do not hold any degrees to my name. However if you want something bad enough you can obtain it through hard work and never giving up. Hence when my first child was born who is now nearly 17 I wanted to provide more for her, as the job I was in at the time barely covered the bills, let alone the shopping. I wanted to earn more money in IT and the way I saw myself doing that would be to become a programmer, Powershell was the new language that had come out, and unlike many other languages out at the time, seemed to be a lot more readable, due to the way the Powershell team had constructed the verb-noun naming methods of the cmdlets.","I do not see it as often these days but a lot of early Powershell scripters used to tweet or post on other social media a one-liner bit of Powershell that did something that might have taken almost 100 lines of code in Visual Basic. This encouraged me more to learn this language and one-day post about my own one-liners. Okay I failed on that in this blog as it is two lines of code not one line. Still using only two lines of code saved me having to repeat this same task on nearly 300 different scheduled tasks. Which as mentioned in my last blog is more likely going to lead to mistakes being made due to repeating the same task and being human, you could forget to do a task, you might spell the new password wrong, it might not copy and paste correctly if you included a white-space or something. Again that is why I choose to script and automate the method as you could try this on just one particular scheduled task, then if you know that worked without issues, it is then just a case of running this in a loop to process all the scheduled tasks."]},{"l":"Code solution","p":["Sometimes it pays not to follow the crowd in a point-and-click world - WorldTr33 comic","The solution allowed me to store the credentials which contained the new password into a variable without hardcoding any sensitive information. Then it was a case of obtaining all the scheduled task in the specific directory within scheduled tasks that the scripts ran from using the Get-ScheduledTask cmdlet. Then pipe that to a Foreach-Object which will then interate through all the scheduled tasks one at a time.","I like to think of this as when you get your shopping scanned at the checkout in a shop they scan one item at a time and the barcode is then giving the properties aka the product and price of that item","except in this case it is the properties of the given scheduled task, the task-path the task-name, and the username and password for each task. Finally using the Set-ScheduledTask to confirm what the details should be for each task processed.","Again this is not send a person to the moon type of complex Powershell script but just keeping it simple to get the given problem accomplished in the least amount of time, making more effective use of my time for the rest of the day.","No need to over-complicate things in life, sometimes life is complicated enough.","I also knew this would give me a 100% success rate as I had tested it prior on just one scheduled task. I mean I could have added this into a try / catch block of code, to follow best practices but I was very confident that there would not be any issues, so opted just to keep it simple and use the verbose parameter to show me the output of what it was doing. To my delight everything went as planned and shocked the person who presented this issue to me when I informed them it was all done and dusted."]},{"l":"Thank you","p":["Thanks again for reading one of my IT tales of problems. I know there was nothing amazing in the code I shared in this blog, but hopefully it will help someone out there who is facing a similar problem, and will now look to use those couple of lines of goodness. Or hopefully it might inspire you to pick up a Powershell book after reading this blog realising that it is not a case of having to be a mad computer scientist to learn this language, and when you do learn it, it can become extremely powerful in just a few lines of code.","So to make you feel a bit more lively after digesting this information, I made a brand-new track last night so here it is, I hope you enjoy the music \uD83C\uDFB5","Until next time stay safe and take care."]}],[{"l":"Powershell Magic"},{"i":"another-book-idea-bulb","l":"Another book idea \uD83D\uDCA1","p":["That feeling you might get at work being the go-to person to ask for things no-one else can do"]},{"i":"quick-puppy-update-dog","l":"Quick puppy update \uD83D\uDC36","p":["As you know I had to get 3 of my puppies eyes tacked, well the two boys had both eyes done, but Frost the female only had one eye done, as the other eye was open and had no issues. However the day after the operation less than 24 hours, the eye that had not been tacked as it was fine was now closed up. Got back in contact with the vet who wanted to leave it for at least a month, due to the pup being so young and the dangers involved putting them under general anaesthetic. However after a week we went back to the vet for take 2 at this. Thankfully the pup went another round like the champ she is, and now has two fully open eyes. Frost is such a nice happy dog, no wonder the mrs wants to keep this one.","Frost now has two open eyes, this picture was before the operation, when she was sleeping"]},{"i":"the-problem-querying-nutanix-confused","l":"The problem querying Nutanix \uD83D\uDE15","p":["So nothing comes as a surprise to me at work, and on this particular day I got informed that we had a 3rd party looking after Nutanix, which was news to me. However there was a problem that they could not gather all the VMs on the different Nutanix prism servers.","Okay well why was I suddenly being told this information? It transpired that the 3rd party company needed help in producing this list of VMs on each prism server. Again you would kind of think well surely this 3rd party would be able to cook up something to solve this issue, as surely they must have other customers or have had this issue before?","Yes, your right to think that, but it wouldn't be another amazing Powershell blog if this was not now my problem to solve. Let me get my costume ready...","Stepping up to another challenge, let me go grab my cape, it's just another supreme day at work","However I am always happy when people ask me to do something, mainly it gives me that confidence boost that they are asking you because they know you are capable of anything and being able to cook up scripts to solve any given issue.","I promise you this time you will be getting more than two lines of Powershell code, this should hopefully open the doorway to using Powershell and APIs. Now unlike VM Ware, Nutanix have not in my opinon done a great job implementing a Powershell module to make this task easy-peasy. They do have a module, but this comes as an executable and well I personally could not get it working, it should have been a simple Install-Module but it turned into a mission to even be able to find the documentation, and the issues of it loading these as an executable and not getting it working, I turned to plan B. No that was not migrating the VM back to VM Ware where it is much easier to communicate with via a well designed Powershell module. No I went a different route, the only one I saw to be able to obtain the data requested"]},{"i":"the-solution-was-to-use-the-api-joystick","l":"The solution was to use the API \uD83D\uDD79️","p":["So Nutanix has a half decent API documentation out there on their site, so this led to a bit of reading to understand how I could query this through Powershell and get the results this 3rd party company needed. After a bit of reading I cooked up the below script for them to run and produce the results."]},{"i":"boom-job-done-boom","l":"Boom job done \uD83D\uDCA5","p":["Just another day at work for Powershell Man taking on all challenges thrown his way","After emailing the script to the 3rd party and informing how to run it, and showing a snippet of the output I got prior when I ran the script, I got the reply from the 3rd party that this was perfect and exactly what they wanted."]},{"i":"party-time-musical_keyboard","l":"Party time \uD83C\uDFB9","p":["Thanks to all the awesome people checking out my music on these blogs. This accounted for 33% of my traffic to youTube so that was great to see I got people checking out my blogs and checking out the music I am sharing. So please enjoy this thow-back with a 90s dance theme to it. Was really happy with this combined the two Roland Compacts I own to create this unique mix-up \uD83C\uDFB5","Until next time stay safe and take care."]}],[{"l":"Powershell Magic","p":["Powershell is here to save the day"]},{"l":"What is Selenium?","p":["So Selenium is a tool to automate the web browser you use. This does not come included in Windows and you will need to download a few things to get this party started. The more modern method seems to be playwright, but to use that I would need to be coding in playwright and then running the script for playwright.","As I want to keep as PowerShell focused as possible Selenium allows you to use code straight from your code editor. Although this is not using PowerShell cmdlets it is using the dotnet from PowerShell to control various aspects. If you have not dabbled with Selenium before then if you follow along this should be something cool to add to your PowerShell toolkit in automating web browsing.","I know you might be thinking well why would I want to automate browsing the web? Do not worry we will get to that shortly."]},{"l":"How do I get Selenium?","p":["Okay so your interested in getting selenium? Good I can walk you through this, it's not too complicated. Firstly I am only going to describe the process for Microsoft Windows users, not because I do not like other operating systems, but this is the operating system I prefer and use over other operating systems.","Also I am just going to focus on Microsoft Edge. It is the browser I use, and it is built into modern Windows Operating systems. If you are still on Internet Explorer then you need to stop using that as it got retired a long time ago.","So on the root of my C:\\ drive I created a folder/directory called WEBDRIVER if you are following along I would recommend to do the same. Then I downloaded the latest Microsoft Edge driver. You can obtain that from the link below","Download the Microsoft Edge Driver here:-","After you downloaded this, add the executable to the newly created WEBDRIVER directory, then add this path aka C:\\WEBDRIVER to the computers Path variable in advanced system options.","As your Microsoft Edge browser should be up-to-date you now need to download two more things to get this rolling","Download the Selenium Web Driver here:-","Once this is downloaded and extracted place this into the same C:\\WEBDRIVER directory. Then finally you need to download and rinse and repeat with the following selenium support package.","Download the Selenium Support package from here:-","All these things should now be living in the newly created directory, and that newly created directory should be added to the system PATH built-in variable","I appreciate this is a few hurdles to jump before using Selenium but once it is done which does not take long you can now use this awesome automated web browser tool."]},{"l":"What was the problem?","p":["Although I have nothing against job-sites as they help you find employment and applying for jobs. As you know I hate pointing and clicking my way through life, so would it not be awesome to run a script, that would go to a particular job-site and then automatically accept the cookies and log you in, and then set the criteria for the type of work you are looking for, then automatically apply for all the jobs, then automatically move through the pagnation at the bottom of the page and rinse and repeat the job applying process. Yes hopefully you can see why this would be beneficial as it can potentially allow you to apply for a crazy amount of jobs without you having to do anything other than run the script.","So the problem for me was manually having to use a job-site to manually search and apply for jobs. I know you might think I am just being lazy, but I wanted to get my CV out there to as many agencies as possible to increase my chances of getting employed. So as I truely believe computers were built to do the hard work for us, lets make your computer crunch some applications for us.","Everyone needs a knight in armor to come save the day"]},{"l":"What was the solution?","p":["I ended up writing a function to complete this task of searching and applying for jobs for me. I have included a synopsis, but I just want to clarify I was using PowerShell 7 to run this function, and I also added the following to my PowerShell 7 Profile aka the $profile","I also added my email address and password as shown in the example, but obviously not going to post this here. Please note this only works for https://www.totaljobs.com/ which is one of the sites I found a good number of UK based jobs on. I did need to spend time right clicking certain fields or links to obtain the unique ID for that element, then was able to use Selenium to do all the hard work for me. You could look at using this as a template and modifying the various HTML element IDs to a job-site you use if you are based outsite the United Kingdom."]},{"l":"Find-TotalJobs Function"},{"l":"Boom another task smashed using PowerShell","p":["Yes I could have made this function better, I could have done more things with it, but it ticked the boxes I needed at the time and as this was a personal project I did not want to be spending a long-time putting this altogether. The longest part of this task was mainly finding all those pesky unique IDs for the various web-elements I needed to interact with, by right clicking on that element on the webpage then choosing inspect, and inspecting the code to find the unique ID to identify just that element.","I know this was a tad different from the work dilemma problems I have been documenting, but this was still a real-world problem and it was work related in a way as in obtaining employment.","Thankfully after using this and getting my phone ringing quite a bit the following day, which proved it really did work in getting me noticed by recruitment agencies, I had a last moment save in my current position. I was due to finish working for my company on the 22nd of this month. It was a really sad time as this has been my first dream job I have had, and it ticks all the boxes for me, so to find another job like the one I currently got was difficult. Due to living in the middle of no-where now, this also really restricted the jobs I could apply for, as many of the jobs I could have applied for were at least a 6 hour drive one-way. So factor in traffic, and the return journey plus the full day at work, I would be working including travelling for over 20+ hours a day. This would have been impossible to do in the long run, and I would never get to see my 5 daughters and wife, as we all live together. Honestly getting that call to give me the option to stay was like the best thing that has happened."]},{"l":"Something to share","p":["As always I got some beats to share if you fancy a listen. \uD83C\uDFB5 This is throw-back beat I done to celebrate when music sounded good, and life was more simple. \uD83C\uDFB5"]}],[{"l":"Powershell Magic","p":["Powershell is here to save the day"]},{"l":"Puppy Update","p":["This is Miami who had his eyes tacked they are looking so good now","Damn these puppies are costing me a fortune before I even fully sold one. Another two pups needed their eyes tacking, so that set me back another £600, had them micro-chiped and jabbed the previous week was another £600. Then plus the £1000 I spent getting three pups eyes tacked and yeah they are now all eating about 4 meals a day. Plus feeding the other 3 dogs I own and it's all stacking up. Just proper thankful I am keeping my current job else I would be going crazy with all these vet bills, as over £2,000 spent out on vet bills alone.","Right moan over, lets tackle a new problem using the mighty PowerShell with a little bit of \uD83E\uDD53 added."]},{"l":"New Problem","p":["So today I was reading my personal emails after work, and got an email from MIDIKLOWD about a bundle offer they were doing. I certainly enjoy a bargin, and well this also seemed to good to be true, 188 midi and wav packs for £30 instead of £99. Each of these packs were being sold separately for like £10 each. So in theory buying all these individually was £1,880. So yeah I was like damn show me the goods, what do I get with this?","MIDIKLOWD Bundle Offer","After scrolling through the list I thought why not, was happy with the packs on offer and 188 was a crazy amount. I spent enough on vet bills might as well treat myself to something nice, but for a fraction of the price."]},{"l":"What has this got to do with PowerShell?","p":["Okay so the PowerShell will come shortly, but just wanted to explain the background to this issue, to see why I thought sod this I need some Magic \uD83E\uDD53 PowerShell. So After I bought the pack I got an email to download them, this then took me to a dedicated webpage with the 188 packs to download, but the issue was there wasn't one download all packs button, there was a 188 different links to click like so:","MIDIKLOWD Bundle Offer Download Page","Another thing was these hyperlinks had a limited download time, so I needed to download these as soon as possible, else a number of days will pass, and the links would have expired. You should know by now, if there is one thing I detest is pointing and clicking. I was thinking damn there is no-way I am sitting here like for hours clicking and downloading. Although to tell the truth I did start to download the first few, but the size of some of these packs were over 1GB so it was not going to be something that could be completed without watching a lot of paint drying so to speak.","Again I totally believe that computers are meant to do the hard or boring work, so us humans can do more interesting things, like writing the code to make the computer do the chore instead of you. Or even better spending the time you would of been manually downloading these links to write a blog about it to share with other PowerShell people out there.","Top Tip: Pressing CTRL + U brings up the source code for the webpage you are on within the browser","I had inspected one of the hyperlinks prior to this, and this showed me where the file was being held. Looking through the source code of the page I could see all the links began with something like: https://bzglfiles.s3.ca-central-1 so the next plan was pressing CTRL+A to highlight all the webpage source code, then CTRL+C open up good old notepad and a CTRL+V to paste this into the notepad and then saving this text file in a memorable location.","So now I had all the source code to the webpage containing the 188 links I needed to download in a dedicated text file. Next step was to get scripting a solution to obtain just the hyperlinks from this text file, then place the hyperlinks into their own text file. Having each hyperlink on a seperate line, then magically download each of the given hyperlinks to a specified location. Here we go a script to help me do just that:"]},{"l":"Next Step...","p":["So this now produced me a text file containing each hyperlink on a line of its own. The final line of the code above outputted that 188 URLs had been extracted to the specified output file. Now it was just a case of downloading each hyperlink which was a zip file then moving onto the next hyperlink to download within the text file containing each hyperlink on a seperate line. I wanted to download one link at a time, as I found the more you try and download then the total-speed is split across the amount you are downloading, I was able to hit 5MB a second downloading just one file at a time, rather than trying to download say 4 files and the speed then dropping to under a megabyte per second per file, as this meant the total time to download each file significantly increased. As I now had the list of hyperlinks to download, next step was to execute downloading each of those whilst I go walk the dogs.","Saved a lot of hassle by automating all these downloads"]},{"l":"Mission Complete","p":["So it did take longer than the dog walk took to download all 188 music midi packs, but this was a whopping 61.5GB of files, and so glad I didn't have to manually click each link and sit there staring at the screen whilst it downloaded, as that would have drived me nuts, with all that pointing and clicking and manually waiting. There were a few more steps to be done, as these were downloaded from the internet, under the properties of the file, you had the option to then unblock the file. I did not want to be doing this 188 times either, so thought simple, I will use PowerShell to do this, yes I do use aliases for cmdlets as makes it a lot quicker to type, but do not fall into bad habbits and make sure that all your production code uses full cmdlet names.","I could now use the Expand-Archive cmdlet to then extract each of these zips, I was a bit paranoid on doing this on all zips I downloaded as if they were 61.5GB zipped I am looking at it being bigger once un-zipped. Plus I wanted to spend time checking out these packs one-by-one and figured to do just that. Then spent a good couple of hours tonight listening to a few of these packs, instead of me spending that time just downloading each of these packs.","I will make sure I add a video to this page once I record a mega mix of some of these new sounds I have purchased."]},{"l":"Message behind this blog","p":["Powershell once again saved the day"]},{"l":"Something to share","p":["So I been browsing through this music bundle, and I really digged this tune, however it was a lot slower to sped it up to a nice 125bpm, then got my J-6 to play the lead as well, to give the tune some extra wow factor, or attempted to get that wow factor. Anyways here is the latest tune I stuck together \uD83C\uDFB5","Till next time stay safe and take care."]}]]