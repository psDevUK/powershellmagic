<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.11.0.812058658231">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.11.0">

    <!-- Primary Meta Tags -->
    <title>Powershell Magic </title>
    <meta name="title" content="Powershell Magic ">
    <meta name="description" content="Hello folks, yes this blog is a few days later than planned, and well there is a good reason for that.">

    <!-- Canonical -->
    <link rel="canonical" href="https://powershellmagic.netlify.app/tenableduplicates/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://powershellmagic.netlify.app/tenableduplicates/">
    <meta property="og:title" content="Powershell Magic ">
    <meta property="og:description" content="Hello folks, yes this blog is a few days later than planned, and well there is a good reason for that.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://powershellmagic.netlify.app/tenableduplicates/">
    <meta property="twitter:title" content="Powershell Magic ">
    <meta property="twitter:description" content="Hello folks, yes this blog is a few days later than planned, and well there is a good reason for that.">

    <script data-cfasync="false">(function(){var cl=document.documentElement.classList,ls=localStorage.getItem("retype_scheme"),hd=cl.contains("dark"),hl=cl.contains("light"),wm=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;if(ls==="dark"||(!ls&&wm&&!hd&&!hl)){cl.remove("light");cl.add("dark")}else if(ls==="light"||(!ls&&!wm&&!hd&&!hl)){cl.remove("dark");cl.add("light")}})();</script>

    <link href="../logo.png" rel="icon">
    <link href="../resources/css/retype.css?v=3.11.0.812058658231" rel="stylesheet">

    <script data-cfasync="false" src="../resources/js/config.js?v=3.11.0.812058658231" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../resources/js/retype.js?v=3.11.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../resources/js/lunr.js?v=3.11.0.812058658231" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../resources/js/prism.js?v=3.11.0.812058658231" defer></script>
</head>
<body>
    <div id="retype-app" class="relative text-base antialiased text-base-text bg-base-bg font-body">
        <div class="absolute bottom-0 left-0" style="top: 5rem; right: 50%"></div>
    
        <header id="retype-header" class="sticky top-0 z-30 flex w-full h-16 bg-header-bg border-b border-header-border md:h-20">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton retype-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="retype-sidebar-left-toggle-button"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="retype-branding-logo" href="../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../logodark.png">
                            </span>
                            <span class="dark:text-white font-bold line-clamp-1 md:line-clamp-2">Automation Ideas</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block border-base-border"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav id="retype-header-nav" class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://adam-bacon.netlify.app/">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                        </g>
                                    </svg>
                                    <span>Old Blog Site</span>
                                </a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-search-placeholder transition-colors duration-200 ease-in bg-search-bg border border-transparent rounded md:text-sm hover:border-search-border-hover focus:outline-none focus:border-search-border-focus" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="retype-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
    
        <div id="retype-container" class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-sidebar-left-bg border-sidebar-left-border sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton">
            
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-filter-bg border border-filter-border rounded shadow-none text-sm focus:outline-none focus:border-filter-border-focus" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-base-border">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-base-border">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-base-border">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://adam-bacon.netlify.app/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                                </g>
                                            </svg>
                                            <span>Old Blog Site</span>
                                        </a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 bg-body-bg">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div id="retype-main" class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="retype-markdown" id="retype-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="retype-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="powershell-magic" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#powershell-magic">#</doc-anchor-trigger>
        <span>Powershell Magic <span class="no-link inline-flex align-middle items-center justify-center font-medium leading-none whitespace-nowrap text-badge-warning-text bg-badge-warning border border-badge-warning-border h-6 px-2 text-xs rounded-md">
            <span>Back once again with the Powershell <span class="docs-emoji">&#x1F953;</span> flavour</span>
        </span></span>
    </h1>
</doc-anchor-target>
<div class="-mt-3 mb-12 flex flex-wrap text-sm text-gray-400 dark:text-dark-350 items-center print:justify-center">
    <div class="flex items-center">
        <div>By</div>
        <div class="ml-2 flex items-center">
          <div class="shrink-0 w-8 h-8 overflow-hidden rounded-full">
            <a href="mailto:adambacon1@hotmail.com"><img class="object-cover" src="https://www.gravatar.com/avatar/aa37a353fed4270a1b0c39b827ee1d23?d=mp"></a>
          </div>
          <div class="ml-1 whitespace-nowrap text-gray-500 dark:text-dark-350"><a href="mailto:adambacon1@hotmail.com">Adam Bacon</a></div>
        </div>
    </div>
    <div class="mx-2">&#9679;</div>
    <div class="flex items-center shrink-0">Published&nbsp;<span>2025-07-28</span></div>
</div>

<p>Hello folks, yes this blog is a few days later than planned, and well there is a good reason for that. Unfortunately I was really sick <span class="docs-emoji">&#x1F92E;</span> all this weekend, but prior to that my wife had it Thursday night, then my youngest daughter, then my eldest daughter, then second eldest, then my third youngest daughter, then my second youngest daughter then I finally got it.  So was a very unpleasant twenty hours of that happening. Guess when you got a family my size and one of you gets ill then you are all bound to get it.</p>
<doc-anchor-target id="not-feeling-well">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#not-feeling-well">#</doc-anchor-trigger>
        <span>Not feeling well</span>
    </h2>
</doc-anchor-target>
<p><figure class="content-center">
    <img src="../images/sick.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<div class="flex mb-6">
    <div class="shrink-0 w-1.5 rounded-tl-lg rounded-bl-lg bg-callout-primary"></div>
    <div class="flex w-full py-4 border border-l-0 rounded-tr-lg rounded-br-lg doc-callout bg-callout-base-bg border-callout-base-border" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-callout-primary" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
<p>Top Tip: Wearing a mask whilst puking your guts up is not a good idea.</p>
        </div>
    </div>
</div>
<p>Moving on swiftly let us talk about some more <strong>Powershell magic</strong> in applying a fix to the problem.</p>
<doc-anchor-target id="what-was-the-problem">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#what-was-the-problem">#</doc-anchor-trigger>
        <span>What was the problem?</span>
    </h2>
</doc-anchor-target>
<p>So the issue we are going to discuss is duplicate assets in Tenable. I know at first you may think well that has nothing to do with Powershell, and you are correct.  However I provided a solution using Powershell and the Tenable APIs to solve the given issue.
Yes this is a problem that seems to have been talked about for years on the internet, but after spending time to look into the issue to see if there was a magic <span class="docs-emoji">&#x1F9D9;</span> hotfix, or patch to apply to Tenable to resolve the issue and finding one did not exist. Then looking on various forums and seeing other Tenable customers were also suffering from this same issue, but no definitive resolution on how they solved it.</p>
<p>
<div class="mb-6 px-5 py-4 flex justify-between relative border border-base-border hover:border-base-border-hover rounded transition-colors duration-150">
    <div class="flex items-center text-base-500">
        <span class="inline-block mb-px">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" role="presentation" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z"/></svg>
        </span>
        <span class="inline-block font-medium ml-2">Example of this problem</span>
    </div>
    <div class="flex items-center text-xs text-gray-400 dark:text-dark-400">
        <span>https://tenable.my.site.com/s/question/0D53a00006FccWECAZ/duplicate-assets-tenableio?language=en_US</span>
    </div>
    <a href="https://tenable.my.site.com/s/question/0D53a00006FccWECAZ/duplicate-assets-tenableio?language=en_US" class="absolute block inset-0"></a>
</div>
</p>
<p>I did find that someone had set a particular registry entry to read-only which then meant Tenable had to use the next criteria to check if the machine is unique. This did make sense in my opinion but I had been informed that, that method had already been tried and did not work.</p>
<doc-anchor-target id="contact-the-vendor">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#contact-the-vendor">#</doc-anchor-trigger>
        <span>Contact the vendor</span>
    </h2>
</doc-anchor-target>
<p>I wanted a proper Tenable solution to this, so I raised the support call with Tenable <span class="docs-emoji">&#x260E;&#xFE0F;</span> who could confirm that the scanning to test if an asset was unique or not was done in this particular order (most useful information I was provided with):</p>
<ol>
<li>Tenable UUID</li>
<li>BIOS UUID</li>
<li>MAC Address</li>
<li>NetBIOS Name</li>
<li>Fully Qualified Domain Name (FQDN)</li>
<li>IPv4 Address</li>
</ol>
<p>As the first option is checking the registry again that made sense to set that as read-only to force Tenable to try the next object in the list. Once again I was denied.</p>
<p>Although I had supplied numerous proof to Tenable that these duplicate assets existed, they wanted access and the passwords to look at the database. I asked for this information but as I was not supplied it from the securty team Tenable closed the call after 7 days of no reply.</p>
<p>It did seem a bit <span class="docs-emoji">&#x1F529;</span> <strong>nuts that Tenable could not supply a fix to a problem that has existed for at least five years</strong>, and just ask for access to your databases, instead of maybe providing checks to do in the database. Or checking specific scan settings, but sometimes it is what it is.
<figure class="content-center">
    <img src="../images/joke.png" alt="Providing not so awesome support to paying customers" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">Providing not so awesome support to paying customers</figcaption>
</figure>
</p>
<doc-anchor-target id="plan-b">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#plan-b">#</doc-anchor-trigger>
        <span>Plan B</span>
    </h2>
</doc-anchor-target>
<p>So although <strong>plan A</strong> did not go as planned, as in I was hoping the vendor would supply a permanent fix to the issue. I still had this issue with numerous duplicate assets in Tenable which I was also sure was affecting the CES <strong>Cyber Exposure Score</strong> by making this inflated as it was counting all the duplicates as unique assets, so any threats these duplicate assets had were being shown numerous times. <span class="docs-emoji">&#x1F9EE;</span></p>
<p>I had spent time <span class="docs-emoji">&#x1F557;</span> looking at a solution on the WWW and found only a potential solution to fix the issue, which I was not allowed to try as apparently it had already been tried. I had reached out directly to the vendor expecting some patch or specific setting which could be changed, but again the support I received, did not provide any information to solve this <span class="docs-emoji">&#x1F622;</span> and <strong>you</strong> are still expected to fix the issue, seeming as <strong>you</strong> were the one who identified it.</p>
<p>I am not to good at planning things in a diagram format, but this was the plan in my head. <strong>So my idea was grab all the assets that are in Tenable, dump them to a CSV file, then use a parameter to seach for particular naming conventions, group all those assets, sort them by descending order and skip the first result.</strong> <span class="docs-emoji">&#x1F92F;</span> Then all that are left in the group are duplicate assets that were not the most recently seen, meaning it was a stale duplicate record.
<figure class="content-center">
    <img src="../images/planb.png" alt="Provide your own solution to a problem, making sure it works" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">Provide your own solution to a problem, making sure it works</figcaption>
</figure>
</p>
<doc-anchor-target id="research">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#research">#</doc-anchor-trigger>
        <span>Research</span>
    </h2>
</doc-anchor-target>
<p>Despite the support I received from Tenable not being the best, as no answer could be provided, just more questions being asked to me. Tenable does have decent documentation on their API and how to use it:</p>
<p>
<div class="mb-6 px-5 py-4 flex justify-between relative border border-base-border hover:border-base-border-hover rounded transition-colors duration-150">
    <div class="flex items-center text-base-500">
        <span class="inline-block mb-px">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" role="presentation" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z"/></svg>
        </span>
        <span class="inline-block font-medium ml-2">Tenable API documentation</span>
    </div>
    <div class="flex items-center text-xs text-gray-400 dark:text-dark-400">
        <span>https://developer.tenable.com/reference/navigate</span>
    </div>
    <a href="https://developer.tenable.com/reference/navigate" class="absolute block inset-0"></a>
</div>
</p>
<p>There is quite a bit of information displayed here, due to there being a lot you can do in Tenable, and this provides the API way of doing each of those things. As hopefully you realise that I am not a <span class="docs-emoji">&#x1F42D;</span> point and click type of guy.</p>
<p>After looking at this documentation <span class="docs-emoji">&#x1F971;</span> I saw there was a method for exporting all the assets, and that is all I really needed as my idea I explained earlier would dump this information into a CSV as a lookup table for particular assets.</p>
<doc-anchor-target id="time-to-get-cooking">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#time-to-get-cooking">#</doc-anchor-trigger>
        <span>Time to get cooking</span>
    </h2>
</doc-anchor-target>
<p><span class="docs-emoji">&#x1F468;&#x200D;&#x1F373;</span> Unlike my previous post I wrote about, I knew from the get-go that I would most certainly be using this solution more than once to fix this issue, as sadly Tenable could never provide an answer to the problem.  As I know it was going to be used more than once, this to me made it worth while into making this into a function.  Maybe even two functions, one to gather all the Tenable assets, then another to find the duplicates.</p>
<div class="codeblock-wrapper"><doc-codeblock line-numbers>
<pre translate="no" class="language-powershell"><code v-pre class="language-powershell">function Get-TenableAssets {
  [CmdletBinding()]
  param(
      # enter the output path to the CSV this must include .csv in the name
      [Parameter(Mandatory=$true,Position=0)]
      [ValidateNotNullOrEmpty()]
      $OutputCSV
  )
  #checking the parent directory exists to place the CSV in
  $parent = Split-Path $OutputCSV -Parent
  $csv = Split-Path $OutputCSV -Leaf
  if (-Not(Test-Path $parent -PathType Container))
  {
      Write-Host -ForegroundColor Yellow &quot;The folder structure $parent does not exist, therefore the file $csv will not be created.  Exiting script&quot;
      break
  }
  $accessKey = $YOUR_TENABLE_ACCESS_KEY
  $secretKey = $YOUR_TENABLE_SECRET_KEY
      $headers = @{
  &quot;X-ApiKeys&quot; = &quot;accessKey=$accessKey; secretKey=$secretKey&quot;
  }
  $headers.Add(&quot;accept&quot;, &quot;application/json&quot;)
  $headers.Add(&quot;content-type&quot;, &quot;application/json&quot;)
  $response = Invoke-WebRequest -Uri 'https://cloud.tenable.com/assets/v2/export' -Method POST -Headers $headers -ContentType 'application/json' -Body '{&quot;chunk_size&quot;:4000}'
  $fileID = ($response.Content | ConvertFrom-Json).export_uuid
  $check = &quot;https://cloud.tenable.com/assets/export/$fileID/status&quot;
  do
  {
  write-host &quot;checking report status, please wait this can take at least a good few minutes&quot;
  $status = (invoke-webrequest -Uri $check -Method Get -Headers $headers).Content | ConvertFrom-Json
  Start-sleep -Seconds 120
  }
  until ($($status.status) -eq 'FINISHED')

  $Assetresponse = Invoke-WebRequest -Uri 'https://cloud.tenable.com/assets/export/status' -Method GET -Headers $headers
  $exports = $Assetresponse.Content | ConvertFrom-Json
  $exportuuid = $exports.exports[0].uuid
  $custom = @()
  $total = $exports.exports[0].total_chunks
  for ($i = 1; $i -le $total; $i++)
  { 
      Write-host &quot;processing object $i of $total please wait...&quot;
      $custom += (Invoke-WebRequest -Uri &quot;https://cloud.tenable.com/assets/export/$exportuuid/chunks/$i&quot; -Method GET -Headers $headers).content | ConvertFrom-Json
  }

  $custom  | select *id,@{n=&quot;last_seen&quot;;E={(Get-Date $_.timestamps.last_seen).ToString('yyyy-MM-dd')}},@{n=&quot;host&quot;;E={$_.network.hostnames}},@{n=&quot;ipv4&quot;;E={$_.network.ipv4s}},@{N=&quot;MAC&quot;;E={$_.network.mac_addresses}} | Export-Csv $OutputCSV -NoTypeInformation -Force
  write-host -ForegroundColor Green &quot;All assets have now been exported to $OutputCSV&quot;
}</code></pre>
</doc-codeblock></div>
<p>The above function will gather all the assets registered in Tenable and place them into a CSV. I know I am missing a help section I promise to do better on my next post, but as I was not publishing this anywhere, and I was going to be the one running it, I thought I should remember something like <strong>Get-TenableAssets -OutputCSV C:\Temp\TenableAssets.csv</strong> yes I know I could have used a more standard parameter like <strong>path</strong> or something similar, but I decided that <strong>OutputCSV</strong> was good enough for the job. This was my function after all. The more assets you have the longer this function will take to run.</p>
<p>Now I needed another function to actually sort the duplicates from the CSV file. Yes I know excel has this built-in to highlight duplicate values, but you would still then need to extract the UUID of the asset to delete, and I did not want to delete all duplicates, as I wanted to keep the one unique one, which would be the most recently seen by Tenable.</p>
<div class="codeblock-wrapper"><doc-codeblock line-numbers>
<pre translate="no" class="language-powershell"><code v-pre class="language-powershell">function Get-DuplicateTenableAssets {
param(
  # enter the full path to the CSV you wish to check for duplicates C:\Temp\TenableAssets.csv
  [Parameter(Mandatory=$true,Position=0)]
  $CSV,
  # enter a search pattern to search on like SERVER to find all SERVER duplicates
  [Parameter(Mandatory=$true,Position=1)]
  $Search
  )
  $custom = import-csv $CSV
  $search = $custom | ? {$_.host -match &quot;$Search&quot;} | select id,last_seen,host,ipv4
  $groupResults = $search | group -Property host | ? count -gt 1
  foreach ($item in $groupResults)
  {
      $currentHost = $($item.Name)
      Write-host &quot;Processing $currentHost which in tenable has $($item.count) occurances of this same machine&quot;
      $filter = $item.Group | Sort last_seen -Descending | Select -ExpandProperty id -Skip 1
      foreach ($item in $filter)
      {
          Write-Host &quot;Removing $currentHost with the tenable_uuid of $item&quot;
          $accessKey = $YOUR_TENABLE_ACCESS_KEY
          $secretKey = $YOUR_TENABLE_SECRET_KEY
          $headers = @{
              &quot;X-ApiKeys&quot; = &quot;accessKey=$accessKey; secretKey=$secretKey&quot;
          }
          $headers.Add(&quot;accept&quot;, &quot;application/json&quot;)
          $headers.Add(&quot;content-type&quot;, &quot;application/json&quot;)
          $body = @&quot;
{
  &quot;query&quot;: {
      &quot;field&quot;: &quot;host.id&quot;,
      &quot;operator&quot;: &quot;eq&quot;,
      &quot;value&quot;: &quot;$item&quot;,
      &quot;hard_delete&quot;: true
  }
}
&quot;@
  Invoke-WebRequest -Uri 'https://cloud.tenable.com/api/v2/assets/bulk-jobs/delete' -Method POST -Headers $headers -ContentType 'application/json' -Body $body
      }
  }
}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="solution">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#solution">#</doc-anchor-trigger>
        <span>Solution</span>
    </h2>
</doc-anchor-target>
<p>By extracting all the Tenable assets with <strong>Get-TenableAssets</strong> function which I only needed to run once.  Then I could use the second function <strong>Get-DuplicateTenableAssets</strong> to search for various naming conventions that I knew duplicates fell under. Although I did not lower the CES as much as I might have hoped, this did go down by at least 15 points. If you work with Tenable you may also know that say fixing 500+ assets with a problem, might only lower the CES score by 1 point.  When I looked at it like that it did make me feel a bit better, and also proved to the doubters in the security team that the duplicate assets were indeed inflating the CES within Tenable. <span class="docs-emoji">&#x1F4A5;</span></p>
<doc-anchor-target id="something-to-share">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#something-to-share">#</doc-anchor-trigger>
        <span>Something to share</span>
    </h2>
</doc-anchor-target>
<p>Yes it is more music I want to share that I put together. I am sure that if you work in IT you most likely played arcade games or oldskool console games when you were younger.  So please enjoy this chiptune inspired music I put together <span class="docs-emoji">&#x1F3B5;</span></p>
<div class="aspect-video w-full rounded-lg overflow-hidden mb-6 shadow-lg dark:shadow-lg">
    <iframe src="https://www.youtube.com/embed/3t7_y22pO1w" frameborder="0" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen class="w-full h-full"></iframe>
</div>
                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer id="retype-content-footer" class="clear-both">
                            
                                <nav id="retype-nextprev" class="print:hidden flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../zeroday/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-base-text-muted">Previous</span>
                                                <span class="block mt-1">Zero-​Day Threats</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../unquotedpath/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-base-text-muted">Next</span>
                                                <span class="block mt-1">Nessus Plugin ID 63155</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div id="retype-page-footer" class="print:border-none border-t border-base-border pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between print:justify-center">
                                <div id="retype-footer-links" class="print:hidden">
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div id="retype-copyright" class="print:justify-center py-2 text-footer-text font-footer-link-weight text-sm leading-relaxed"><p>© Copyright 2025. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-sidebar-right-bg border-sidebar-right-border lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="retype-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "Tenable Duplicate Assets", level: 1, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
