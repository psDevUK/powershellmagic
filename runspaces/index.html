<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.11.0.814906983691">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.11.0">

    <!-- Primary Meta Tags -->
    <title>Powershell Magic </title>
    <meta name="title" content="Powershell Magic ">
    <meta name="description" content="Powershell is here to save the day">

    <!-- Canonical -->
    <link rel="canonical" href="https://powershellmagic.netlify.app/runspaces/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://powershellmagic.netlify.app/runspaces/">
    <meta property="og:title" content="Powershell Magic ">
    <meta property="og:description" content="Powershell is here to save the day">
    <meta property="og:image" content="https://powershellmagic.netlify.app/images/ps.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://powershellmagic.netlify.app/runspaces/">
    <meta property="twitter:title" content="Powershell Magic ">
    <meta property="twitter:description" content="Powershell is here to save the day">
    <meta property="twitter:image" content="https://powershellmagic.netlify.app/images/ps.png">

    <script data-cfasync="false">(function(){var cl=document.documentElement.classList,ls=localStorage.getItem("retype_scheme"),hd=cl.contains("dark"),hl=cl.contains("light"),wm=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;if(ls==="dark"||(!ls&&wm&&!hd&&!hl)){cl.remove("light");cl.add("dark")}else if(ls==="light"||(!ls&&!wm&&!hd&&!hl)){cl.remove("dark");cl.add("light")}})();</script>

    <link href="../logo.png" rel="icon">
    <link href="../resources/css/retype.css?v=3.11.0.814906983691" rel="stylesheet">

    <script data-cfasync="false" src="../resources/js/config.js?v=3.11.0.814906983691" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../resources/js/retype.js?v=3.11.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../resources/js/lunr.js?v=3.11.0.814906983691" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../resources/js/prism.js?v=3.11.0.814906983691" defer></script>
</head>
<body>
    <div id="retype-app" class="relative text-base antialiased text-base-text bg-base-bg font-body">
        <div class="absolute bottom-0 left-0" style="top: 5rem; right: 50%"></div>
    
        <header id="retype-header" class="sticky top-0 z-30 flex w-full h-16 bg-header-bg border-b border-header-border md:h-20">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton retype-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="retype-sidebar-left-toggle-button"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="retype-branding-logo" href="../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../logodark.png">
                            </span>
                            <span class="dark:text-white font-bold line-clamp-1 md:line-clamp-2">Automation Ideas</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block border-base-border"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav id="retype-header-nav" class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://adam-bacon.netlify.app/">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                        </g>
                                    </svg>
                                    <span>Old Blog Site</span>
                                </a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-search-placeholder transition-colors duration-200 ease-in bg-search-bg border border-transparent rounded md:text-sm hover:border-search-border-hover focus:outline-none focus:border-search-border-focus" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="retype-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
    
        <div id="retype-container" class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-sidebar-left-bg border-sidebar-left-border sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton">
            
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-filter-bg border border-filter-border rounded shadow-none text-sm focus:outline-none focus:border-filter-border-focus" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-base-border">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-base-border">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-base-border">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text-weight hover:text-header-text-hover" href="https://adam-bacon.netlify.app/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M13.22 19.03a.75.75 0 0 1 0-1.06L18.19 13H3.75a.75.75 0 0 1 0-1.5h14.44l-4.97-4.97a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                                </g>
                                            </svg>
                                            <span>Old Blog Site</span>
                                        </a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 bg-body-bg">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div id="retype-main" class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="retype-markdown" id="retype-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="retype-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="powershell-magic" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#powershell-magic">#</doc-anchor-trigger>
        <span>Powershell Magic <span class="no-link inline-flex align-middle items-center justify-center font-medium leading-none whitespace-nowrap text-badge-warning-text bg-badge-warning border border-badge-warning-border h-6 px-2 text-xs rounded-md">
            <span>Back once again with the Powershell <span class="docs-emoji">&#x1F953;</span> flavour</span>
        </span></span>
    </h1>
</doc-anchor-target>
<div class="-mt-3 mb-12 flex flex-wrap text-sm text-gray-400 dark:text-dark-350 items-center print:justify-center">
    <div class="flex items-center">
        <div>By</div>
        <div class="ml-2 flex items-center">
          <div class="shrink-0 w-8 h-8 overflow-hidden rounded-full">
            <a href="mailto:adambacon1@hotmail.com"><img class="object-cover" src="https://www.gravatar.com/avatar/aa37a353fed4270a1b0c39b827ee1d23?d=mp"></a>
          </div>
          <div class="ml-1 whitespace-nowrap text-gray-500 dark:text-dark-350"><a href="mailto:adambacon1@hotmail.com">Adam Bacon</a></div>
        </div>
    </div>
    <div class="mx-2">&#9679;</div>
    <div class="flex items-center shrink-0">Published&nbsp;<span>2025-09-05</span></div>
</div>

<p><figure class="content-center">
    <img src="../images/ps.png" alt="Powershell is here to save the day" class="rounded-image-rounded border-image-border border-image-border-width" width="500" />
    <figcaption class="caption">Powershell is here to save the day</figcaption>
</figure>
</p>
<doc-anchor-target id="puppy-update">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#puppy-update">#</doc-anchor-trigger>
        <span>Puppy update</span>
    </h2>
</doc-anchor-target>
<p>So after 5 of the 7 pups having to have their eyes tacked, and costing me over £2,500 in vet bills, the first puppy went to her new forever home, the couple are lovely and have a big garden and really nice house. So know she will be treated like a princess. I got 2 boys being sold tonight to a son and dad. So again nice that the two brothers will see each other even though with seperate people, and again really happy with the son and dad buying these as both were nice people who have previously owned a Shar Pei.</p>
<p>I mean it is so sad to see so many older Shar Peis being re-homed, to me a dog is for life, not for covid, or till circumstances change. Enough said on that as personally do not think there are enough laws to protect animals in the UK.  Like let us just say I know a family with a guide dog that is never walked, and left sometimes for 24 hours or more all alone, frquently being left at home all day alone. Mentioning no names, but to me this is neglect of the dog that was trained to improve someones life and yet their life (the dog) is now being made a living hell. But after looking this up apparently it is not illegal to never walk your dog.  Which to me is nuts as that is all part and parcel of owning a dog, I mean I walk mine 3 times a day, in my opinion there is no excuse not to walk your dog. Well enough moaning about bad dog owners, lets move on to this blogs topic.</p>
<p><figure class="content-center">
    <img src="../images/dog.png" alt="Feel so sorry and sad for this dog never being walked and left at home all day most days" class="rounded-image-rounded border-image-border border-image-border-width" width="500" />
    <figcaption class="caption">Feel so sorry and sad for this dog never being walked and left at home all day most days</figcaption>
</figure>
</p>
<doc-anchor-target id="runspaces">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#runspaces">#</doc-anchor-trigger>
        <span>Runspaces</span>
    </h2>
</doc-anchor-target>
<p>I know I might not be famous, or an MVP like IT famous, but I have had good feedback on the blogs I been doing, which inspires me to write more. I had Cody reach out on LinkedIn for the one line of code in my last blog about unblocking files. I was like thanks, is there anything I could write a blog on which would interest you more.</p>
<p>So folks we got Cody to thank for this blog. It is all going to be about runspaces in PowerShell and what they are and how to use them.</p>
<p>Now sadly I am not a genius who knows everything, so spoiler alert, I did do a tiny bit of research to make sure I could confidently write about something and also sound like I know what I am on about. Like I never finished college and never went to university to study, so literally just hold GCSEs to my name, as not everything made sense to me being taught in a room, by a person who can maybe only explain that subject or topic in their particular way and could never provide another easier to understand method.  For me having like a real-world comparison to compare that topic to greatly helps me understand it better. So here we go on me trying to compare it to something that is not PowerShell but will give you a visual concept in your head to understand it. So without rambling on to much let us first address the big question.</p>
<doc-anchor-target id="what-is-a-powershell-runspace">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#what-is-a-powershell-runspace">#</doc-anchor-trigger>
        <span>What is a PowerShell runspace</span>
    </h2>
</doc-anchor-target>
<p><figure class="content-center">
    <img src="../images/duplikate.png" alt="DupliKate from Invincible comics is like a runspace, one person (PowerShell session) able to spawn multiple versions of herself (runspaces) to complete the task quicker. Simple right." class="rounded-image-rounded border-image-border border-image-border-width" width="500" />
    <figcaption class="caption">DupliKate from Invincible comics is like a runspace, one person (PowerShell session) able to spawn multiple versions of herself (runspaces) to complete the task quicker. Simple right.</figcaption>
</figure>
</p>
<p>Runspaces are lightweight, isolated execution environments where PowerShell code can run independently. Think of them as threads tailored for PowerShell, allowing you to:</p>
<ul>
<li>Run multiple tasks simultaneously without launching separate powershell.exe processes.</li>
<li>Maintain shared context (e.g., variables, modules) across threads if needed.</li>
<li>Handle asynchronous execution with better control than background jobs.</li>
</ul>
<p>They are especially useful when you&#x27;re building automation that needs to scale such as pinging thousands of endpoints, processing logs, or running compliance checks across a large amount of machines. Runspaces are your new best friend to help complete the task/script in a much more timely manner.</p>
<div class="flex mb-6">
    <div class="shrink-0 w-1.5 rounded-tl-lg rounded-bl-lg bg-callout-primary"></div>
    <div class="flex w-full py-4 border border-l-0 rounded-tr-lg rounded-br-lg doc-callout bg-callout-base-bg border-callout-base-border" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-callout-primary" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
<p><strong>Do not worry let us break this down into a real-world scenario that you can relate to</strong></p>
        </div>
    </div>
</div>
<doc-anchor-target id="real-world-scenario">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#real-world-scenario">#</doc-anchor-trigger>
        <span>Real-world scenario</span>
    </h2>
</doc-anchor-target>
<p>Imagine PowerShell as a your local super-store (script), and every time you run a script, you are collecting the items you want to buy. Normally in this super-store, there is only one person working on the till to serve the customers (your main PowerShell session) working on one customer at a time. (single thread)</p>
<p>If like me and you hate waiting in queues, wouldn&#x27;t it be great if that one person could serve multiple people at the same time, but it cannot because it is a single person aka thread and can only process one customer at a time. (or object like a computer)</p>
<p>So lets say the owner of this store comes in and sees the amount of people queuing to be served and thinks why don&#x27;t I hire more staff to work on the different tills (runspaces), if I get three more staff working on tills we will be able to serve 4 customers at the same time.(runspace pools)</p>
<p>This in essence is exactly what runspaces are. The ability to have multiple check-out staff (multiple threads) all working in parallel, each serving their own queue of customers which then makes me as a customer checking out quicker to be processed as instead of just one person and one long queue, there is now a choice of 4 different tills to go to, which gets the job of paying for your items (running your script) a quicker process to complete. Each of these checkout staff is the equivalent to a runspace they are all different people working on their own till (runspace) but still all part of the same super-store (script).</p>
<p>Hopefully after reading the above explanation this has allowed you to picture this in your head what runspaces are and how they can use multiple threads aka checkout staff to allow your PowerShell script aka the super-store a better way to process more customers (objects) instead of using the normal single thread, as in one checkout staff.</p>
<p>I am bad for this, as normally when I write code, say to apply a given fix to a list of computers, I process the list of computers (customers in the queue) in a foreach loop (single thread) and apply what needs doing in the script to the current item in that foreach loop processing one item at a time. Now hopefully you can see doing it this way is like having that single checkout worker on the till, and the list of computers to be processed in that foreach loop is like the queue of customers waiting to be served, PowerShell will only process one computer at a time, as by default it is just using a single thread to do the work you want doing.</p>
<p>Hopefully this is getting you thinking tell me more about runspaces, and I will, just hold on and keep reading.</p>
<doc-anchor-target id="runspaces-break-down">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#runspaces-break-down">#</doc-anchor-trigger>
        <span>Runspaces break-down</span>
    </h2>
</doc-anchor-target>
<div class="flex mb-6">
    <div class="shrink-0 w-1.5 rounded-tl-lg rounded-bl-lg bg-callout-primary"></div>
    <div class="flex w-full py-4 border border-l-0 rounded-tr-lg rounded-br-lg doc-callout bg-callout-base-bg border-callout-base-border" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-callout-primary" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
<p><strong>Without runspaces:</strong> One checkout staff member serves one customer at a time. Meaning customers wait longer to be served.</p>
        </div>
    </div>
</div>
<div class="flex mb-6">
    <div class="shrink-0 w-1.5 rounded-tl-lg rounded-bl-lg bg-callout-primary"></div>
    <div class="flex w-full py-4 border border-l-0 rounded-tr-lg rounded-br-lg doc-callout bg-callout-base-bg border-callout-base-border" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-callout-primary" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
<p><strong>With runspaces:</strong> More checkout staff, each with their own checkout till. Serving multiple customers at once. Less time to be served</p>
        </div>
    </div>
</div>
<p>In PowerShell terms referring to the super-store example. Each runspace is a dedicated check out staff member with their own till which is the equivalent to a runspace.</p>
<p>Your main script is the super-store with customers shopping, picking items to buy. You can create a runspace pool, which is the same as hiring  multiple checkout staff members and using them to keep the queues as low as possible to be processed. Hopefully reading it like this will clarify the mystery behind runspaces and when to use them, and the benefits using runspaces. If not keep reading to find out more benefits of using them:</p>
<ul>
<li><strong>Speed:</strong> Allows you to run things that need to be processed such as a list of computers in parallel. For example pinging 100 computers in one swoop instead of processing one computer at a time.</li>
<li><strong>Efficiency:</strong> By implementing run spaces is way more memory efficient than say launching 5 different PowerShell.exe consoles to work on. Runspaces use less memory than a console session.</li>
<li><strong>Control:</strong> Allowing you to manage what each runspace does, tracking the progress, and handling any errors that may occur.</li>
</ul>
<p>Hopefully this is getting you thinking wow, I need to start using runspaces, but you maybe also thinking are runspaces compatible with the version of PowerShell I use?</p>
<doc-anchor-target id="what-versions-of-powershell-support-runspaces">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#what-versions-of-powershell-support-runspaces">#</doc-anchor-trigger>
        <span>What versions of PowerShell support runspaces?</span>
    </h2>
</doc-anchor-target>
<p>Believe it or not but runspaces are backwards compatible all the way from PowerShell version 2, up until the most recent, PowerShell version 7, lets break this down into a table to see this more easily.</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>PowerShell Version</th>
<th>Runspace Support</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>v2.0</td>
<td>Supported</td>
<td>Legacy support; heavier syntax</td>
</tr>
<tr>
<td>v3.0–v5.1</td>
<td>Supported</td>
<td>Improved performance and syntax</td>
</tr>
<tr>
<td>PowerShell 7+</td>
<td>Supported</td>
<td>Still valid, though ForEach-Object -Parallel is often preferred for simple parallelism</td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="code-example">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#code-example">#</doc-anchor-trigger>
        <span>Code Example</span>
    </h2>
</doc-anchor-target>
<p>As I admitted earlier, my normal choice of processing things is to do it in a foreach loop, so to keep this simple lets say I want to get all the services which are set to automatically start but are not currently running</p>
<div class="codeblock-wrapper"><doc-codeblock line-numbers>
<pre translate="no" class="language-powershell"><code v-pre class="language-powershell"># Define your list of servers
$servers = @(&quot;Server01&quot;, &quot;Server02&quot;, &quot;Server03&quot;, &quot;Server04&quot;, &quot;Server05&quot;,
             &quot;Server06&quot;, &quot;Server07&quot;, &quot;Server08&quot;, &quot;Server09&quot;, &quot;Server10&quot;)
# Process each computer one computer at a time
foreach ($server in $servers) {
    Get-Service -ComputerName $server | ? {$_.StartType -match &quot;Automatic&quot; -and $_.Status -ne &quot;Running&quot;} | Select @{N=&quot;ComputerName&quot;;E={$server}},Name,Status
}</code></pre>
</doc-codeblock></div>
<p>Yes this works and as we are only processing 10 machines in this given case it probably won&#x27;t take too long, but what if that list was 10,000 computers. That is a prime example of using the runspace method to process these, even if it does require a bit more code. Again to keep things simple, let us re-code the first example to then re-write this with using it with runspaces.</p>
<div class="codeblock-wrapper"><doc-codeblock line-numbers>
<pre translate="no" class="language-powershell"><code v-pre class="language-powershell"># Define your list of servers
$servers = @(&quot;Server01&quot;, &quot;Server02&quot;, &quot;Server03&quot;, &quot;Server04&quot;, &quot;Server05&quot;,
             &quot;Server06&quot;, &quot;Server07&quot;, &quot;Server08&quot;, &quot;Server09&quot;, &quot;Server10&quot;)

# Create a runspace pool
$runspacePool = [runspacefactory]::CreateRunspacePool(1, 5)  # Min 1, Max 5 threads
$runspacePool.Open()

# Create a collection to hold runspace jobs
$runspaces = @()

foreach ($server in $servers) {
    $powershell = [powershell]::Create()
    $powershell.RunspacePool = $runspacePool

    # Add the script block and pass the server name
    $powershell.AddScript({
        param($srv)
    # Add try catch block for error handling
        try {
            Get-Service -ComputerName $srv -EA Stop | ? {$_.StartType -match &quot;Automatic&quot; -and $_.Status -ne &quot;Running&quot;} | Select @{N=&quot;ComputerName&quot;;E={$server}},Name,Status
        } catch {
            [PSCustomObject]@{
                Server = $srv
                Error  = $_.Exception.Message
            }
        }
    }).AddArgument($server)

    # Start async execution
    $runspace = @{
        Pipe     = $powershell
        Status   = $powershell.BeginInvoke()
        Server   = $server
    }
    $runspaces += $runspace
}

# Collect results by creating an empty array to store the results in
$results = @()
foreach ($runspace in $runspaces) {
    $output = $runspace.Pipe.EndInvoke($runspace.Status)
    $results += $output
    $runspace.Pipe.Dispose()
}

# Close the runspace pool
$runspacePool.Close()
$runspacePool.Dispose()

# Display results
$results | Format-Table -AutoSize</code></pre>
</doc-codeblock></div>
<p>Yeah there is a fair amount more code to type to run the same script using a runspace, but surely if this will allow your scripts to run quicker and get the end result quicker it is worth investing that time, and as we are only using a simple one line of code. As in finding all services on each given machine that should have started but are not currently running. Then, effectively the above example could be used as a template to just remove that one line of code, and add the code you want to process for your list of objects.</p>
<p>In the example above we have set it to effectively use up to 5 different checkout members of staff, and as the queue is only 10 customers long, as that is the amount of computers specified to process, in a perfect world 2 customers per queue, which as you can hopefully visualize will mean super quick checkout time. However your brain may also be thinking well how many runspace pools can I create?  This does depend on a few factors of the machine you are running the code from, so lets look at the below table to understand those factors.</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Factor</th>
<th>Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU cores</td>
<td>More cores = more threads you can run efficiently</td>
</tr>
<tr>
<td>Memory</td>
<td>Each thread consumes memory; too many can cause thrashing</td>
</tr>
<tr>
<td>Task complexity</td>
<td>Lightweight tasks (e.g., pinging) scale better than heavy ones (e.g., file I/O, WMI queries)</td>
</tr>
<tr>
<td>Network latency</td>
<td>If tasks are mostly waiting on network responses, you can afford more threads</td>
</tr>
<tr>
<td>Thread management overhead</td>
<td>Too many threads can overwhelm the main thread managing them</td>
</tr>
</tbody>
</table>
</div>
<p>Boom, I think that is a rap on runspaces what they are when to use them, and how to use them. Thank you for attending my class today on runspaces, it has been great to write this, and hopefully it has been insightful for you. Once again shout-out to Cody for asking for this to be blogged about. Mission complete.</p>
<doc-anchor-target id="something-to-share">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#something-to-share">#</doc-anchor-trigger>
        <span>Something to share</span>
    </h2>
</doc-anchor-target>
<p>I don&#x27;t know why it took me as long as it did. But finally hooked up my J-6 to my DAW as an output midi, which then allowed me to identify the notes way easier than the manual. This then got me jamming, so I hope you enjoy the synthwave tune I put together last night <span class="docs-emoji">&#x1F3B5;</span></p>
<div class="aspect-video w-full rounded-lg overflow-hidden mb-6 shadow-lg dark:shadow-lg">
    <iframe src="https://www.youtube.com/embed/Gt4MVWVGcfE" frameborder="0" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen class="w-full h-full"></iframe>
</div>
<p>Till next time stay safe and take care.</p>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer id="retype-content-footer" class="clear-both">
                            
                                <nav id="retype-nextprev" class="print:hidden flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../downloading/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-base-text-muted">Previous</span>
                                                <span class="block mt-1">Downloading</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-body-link border border-base-border hover:border-base-border-hover rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../whatif/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-base-text-muted">Next</span>
                                                <span class="block mt-1">What​If</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div id="retype-page-footer" class="print:border-none border-t border-base-border pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between print:justify-center">
                                <div id="retype-footer-links" class="print:hidden">
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div id="retype-copyright" class="print:justify-center py-2 text-footer-text font-footer-link-weight text-sm leading-relaxed"><p>© Copyright 2025. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-sidebar-right-bg border-sidebar-right-border lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="retype-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "Runspaces", level: 1, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
